<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">281</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Loop Counter Iteration with range and xrange</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0281.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">magnus&#32;&#97;t&#32;hetland.org (Magnus Lie Hetland)</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Rejected</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">11-Feb-2002</td>
</tr>
<tr class="field"><th class="field-name">Python-Version:</th><td class="field-body">2.3</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id3">Abstract</a></li>
<li><a class="reference internal" href="#pronouncement" id="id4">Pronouncement</a></li>
<li><a class="reference internal" href="#motivation" id="id5">Motivation</a></li>
<li><a class="reference internal" href="#specification" id="id6">Specification</a></li>
<li><a class="reference internal" href="#alternatives" id="id7">Alternatives</a></li>
<li><a class="reference internal" href="#backwards-compatibility" id="id8">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#references-and-footnotes" id="id9">References and Footnotes</a></li>
<li><a class="reference internal" href="#copyright" id="id10">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id3">Abstract</a></h1>
<p>This PEP describes yet another way of exposing the loop counter in
for-loops. It basically proposes that the functionality of the
function <tt class="docutils literal">indices()</tt> from <a class="reference external" href="/dev/peps/pep-0212">PEP 212</a> <a class="footnote-reference" href="#id2" id="id1">[1]</a> be included in the existing
functions <tt class="docutils literal">range()</tt> and <tt class="docutils literal">xrange()</tt>.</p>
</div>
<div class="section" id="pronouncement">
<h1><a class="toc-backref" href="#id4">Pronouncement</a></h1>
<p>In commenting on <a class="reference external" href="/dev/peps/pep-0279">PEP 279</a>'s <tt class="docutils literal">enumerate()</tt> function, this PEP's author
offered, &quot;I'm quite happy to have it make <a class="reference external" href="/dev/peps/pep-0281">PEP 281</a> obsolete.&quot;
Subsequently, <a class="reference external" href="/dev/peps/pep-0279">PEP 279</a> was accepted into Python 2.3.</p>
<p>On 17 June 2005, the BDFL concurred with it being obsolete and
hereby rejected the PEP.  For the record, he found some of the
examples to somewhat jarring in appearance:</p>
<pre class="literal-block">
&gt;&gt;&gt; range(range(5), range(10), range(2))
[5, 7, 9]
</pre>
</div>
<div class="section" id="motivation">
<h1><a class="toc-backref" href="#id5">Motivation</a></h1>
<p>It is often desirable to loop over the indices of a sequence.  <a class="reference external" href="/dev/peps/pep-0212">PEP
212</a> describes several ways of doing this, including adding a
built-in function called indices, conceptually defined as:</p>
<pre class="literal-block">
def indices(sequence):
    return range(len(sequence))
</pre>
<p>On the assumption that adding functionality to an existing built-in
function may be less intrusive than adding a new built-in function,
this PEP proposes adding this functionality to the existing
functions <tt class="docutils literal">range()</tt> and <tt class="docutils literal">xrange()</tt>.</p>
</div>
<div class="section" id="specification">
<h1><a class="toc-backref" href="#id6">Specification</a></h1>
<p>It is proposed that all three arguments to the built-in functions
<tt class="docutils literal">range()</tt> and <tt class="docutils literal">xrange()</tt> are allowed to be objects with a length
(i.e. objects implementing the <tt class="docutils literal">__len__</tt> method).  If an argument
cannot be interpreted as an integer (i.e. it has no <tt class="docutils literal">__int__</tt>
method), its length will be used instead.</p>
<p>Examples:</p>
<pre class="literal-block">
&gt;&gt;&gt; range(range(10))
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
&gt;&gt;&gt; range(range(5), range(10))
[5, 6, 7, 8, 9]
&gt;&gt;&gt; range(range(5), range(10), range(2))
[5, 7, 9]
&gt;&gt;&gt; list(xrange(range(10)))
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
&gt;&gt;&gt; list(xrange(xrange(10)))
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

# Number the lines of a file:
lines = file.readlines()
for num in range(lines):
    print num, lines[num]
</pre>
</div>
<div class="section" id="alternatives">
<h1><a class="toc-backref" href="#id7">Alternatives</a></h1>
<p>A natural alternative to the above specification is allowing
<tt class="docutils literal">xrange()</tt> to access its arguments in a lazy manner.  Thus, instead
of using their length explicitly, <tt class="docutils literal">xrange</tt> can return one index for
each element of the stop argument until the end is reached.  A
similar lazy treatment makes little sense for the start and step
arguments since their length must be calculated before iteration
can begin.  (Actually, the length of the step argument isn't needed
until the second element is returned.)</p>
<p>A pseudo-implementation (using only the stop argument, and assuming
that it is iterable) is:</p>
<pre class="literal-block">
def xrange(stop):
    i = 0
    for x in stop:
        yield i
        i += 1
</pre>
<p>Testing whether to use <tt class="docutils literal">int()</tt> or lazy iteration could be done by
checking for an <tt class="docutils literal">__iter__</tt> attribute.  (This example assumes the
presence of generators, but could easily have been implemented as a
plain iterator object.)</p>
<p>It may be questionable whether this feature is truly useful, since
one would not be able to access the elements of the iterable object
inside the for loop through indexing.</p>
<p>Example:</p>
<pre class="literal-block">
# Printing the numbers of the lines of a file:
for num in range(file):
    print num # The line itself is not accessible
</pre>
<p>A more controversial alternative (to deal with this) would be to
let <tt class="docutils literal">range()</tt> behave like the function <tt class="docutils literal">irange()</tt> of <a class="reference external" href="/dev/peps/pep-0212">PEP 212</a> when
supplied with a sequence.</p>
<p>Example:</p>
<pre class="literal-block">
&gt;&gt;&gt; range(5)
[0, 1, 2, 3, 4]
&gt;&gt;&gt; range('abcde')
[(0, 'a'), (1, 'b'), (2, 'c'), (3, 'd'), (4, 'e')]
</pre>
</div>
<div class="section" id="backwards-compatibility">
<h1><a class="toc-backref" href="#id8">Backwards Compatibility</a></h1>
<p>The proposal could cause backwards incompatibilities if arguments
are used which implement both <tt class="docutils literal">__int__</tt> and <tt class="docutils literal">__len__</tt> (or <tt class="docutils literal">__iter__</tt> in
the case of lazy iteration with <tt class="docutils literal">xrange</tt>).  The author does not
believe that this is a significant problem.</p>
</div>
<div class="section" id="references-and-footnotes">
<h1><a class="toc-backref" href="#id9">References and Footnotes</a></h1>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="/dev/peps/pep-0212">PEP 212</a>, Loop Counter Iteration
<a class="reference external" href="http://www.python.org/dev/peps/pep-0212/">http://www.python.org/dev/peps/pep-0212/</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id10">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
fill-column: 70
End: -->
</div>


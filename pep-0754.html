<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">754</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">IEEE 754 Floating Point Special Values</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0754.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Gregory R. Warnes &lt;gregory_r_warnes&#32;&#97;t&#32;groton.pfizer.com&gt; (Pfizer, Inc.)</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Rejected</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">28-Mar-2003</td>
</tr>
<tr class="field"><th class="field-name">Python-Version:</th><td class="field-body">2.3</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#rejection-notice" id="id5">Rejection Notice</a></li>
<li><a class="reference internal" href="#abstract" id="id6">Abstract</a></li>
<li><a class="reference internal" href="#rationale" id="id7">Rationale</a></li>
<li><a class="reference internal" href="#api-definition" id="id8">API Definition</a><ul>
<li><a class="reference internal" href="#constants" id="id9">Constants</a></li>
<li><a class="reference internal" href="#functions" id="id10">Functions</a></li>
<li><a class="reference internal" href="#example" id="id11">Example</a></li>
<li><a class="reference internal" href="#implementation" id="id12">Implementation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id13">References</a></li>
<li><a class="reference internal" href="#copyright" id="id14">Copyright</a></li>
</ul>
</div>
<div class="section" id="rejection-notice">
<h1><a class="toc-backref" href="#id5">Rejection Notice</a></h1>
<p>This PEP has been rejected. After sitting open for four years, it has
failed to generate sufficient community interest.</p>
<p>Several ideas of this PEP were implemented for Python 2.6. <tt class="docutils literal"><span class="pre">float('inf')</span></tt>
and <tt class="docutils literal"><span class="pre">repr(float('inf'))</span></tt> are now guaranteed to work on every supported
platform with IEEE 754 semantics. However the <tt class="docutils literal"><span class="pre">eval(repr(float('inf')))</span></tt>
roundtrip is still not supported unless you define inf and nan yourself:</p>
<pre class="literal-block">
&gt;&gt;&gt; inf = float('inf')
&gt;&gt;&gt; inf, 1E400
(inf, inf)
&gt;&gt;&gt; neginf = float('-inf')
&gt;&gt;&gt; neginf, -1E400
(-inf, -inf)
&gt;&gt;&gt; nan = float('nan')
&gt;&gt;&gt; nan, inf * 0.
(nan, nan)
</pre>
<p>The math and the sys module also have gained additional features,
<tt class="docutils literal">sys.float_info</tt>, <tt class="docutils literal">math.isinf</tt>, <tt class="docutils literal">math.isnan</tt>, <tt class="docutils literal">math.copysign</tt>.</p>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id6">Abstract</a></h1>
<p>This PEP proposes an API and a provides a reference module that
generates and tests for IEEE 754 double-precision special values:
positive infinity, negative infinity, and not-a-number (NaN).</p>
</div>
<div class="section" id="rationale">
<h1><a class="toc-backref" href="#id7">Rationale</a></h1>
<p>The IEEE 754 standard defines a set of binary representations and
algorithmic rules for floating point arithmetic.  Included in the
standard is a set of constants for representing special values,
including positive infinity, negative infinity, and indeterminate or
non-numeric results (NaN).  Most modern CPUs implement the
IEEE 754 standard, including the (Ultra)SPARC, PowerPC, and x86
processor series.</p>
<p>Currently, the handling of IEEE 754 special values in Python depends
on the underlying C library.  Unfortunately, there is little
consistency between C libraries in how or whether these values are
handled.  For instance, on some systems &quot;float('Inf')&quot; will properly
return the IEEE 754 constant for positive infinity.  On many systems,
however, this expression will instead generate an error message.</p>
<p>The output string representation for an IEEE 754 special value also
varies by platform.  For example, the expression &quot;float(1e3000)&quot;,
which is large enough to generate an overflow, should return a string
representation corresponding to IEEE 754 positive infinity.  Python
2.1.3 on x86 Debian Linux returns &quot;inf&quot;.  On Sparc Solaris 8 with
Python 2.2.1, this same expression returns &quot;Infinity&quot;, and on
MS-Windows 2000 with Active Python 2.2.1, it returns &quot;1.#INF&quot;.</p>
<p>Adding to the confusion, some platforms generate one string on
conversion from floating point and accept a different string for
conversion to floating point.  On these systems</p>
<pre class="literal-block">
float(str(x))
</pre>
<p>will generate an error when &quot;x&quot; is an IEEE special value.</p>
<p>In the past, some have recommended that programmers use expressions
like:</p>
<pre class="literal-block">
PosInf = 1e300**2
NaN = PosInf/PosInf
</pre>
<p>to obtain positive infinity and not-a-number constants.  However, the
first expression generates an error on current Python interpreters.  A
possible alternative is to use:</p>
<pre class="literal-block">
PosInf = 1e300000
NaN = PosInf/PosInf
</pre>
<p>While this does not generate an error with current Python
interpreters, it is still an ugly and potentially non-portable hack.
In addition, defining NaN in this way does solve the problem of
detecting such values.  First, the IEEE 754 standard provides for an
entire set of constant values for Not-a-Number.  Second, the standard
requires that</p>
<pre class="literal-block">
NaN != X
</pre>
<p>for all possible values of X, including NaN.  As a consequence</p>
<pre class="literal-block">
NaN == NaN
</pre>
<p>should always evaluate to false.  However, this behavior also is not
consistently implemented.  [e.g. Cygwin Python 2.2.2]</p>
<p>Due to the many platform and library inconsistencies in handling IEEE
special values, it is impossible to consistently set or detect IEEE
754 floating point values in normal Python code without resorting to
directly manipulating bit-patterns.</p>
<p>This PEP proposes a standard Python API and provides a reference
module implementation which allows for consistent handling of IEEE 754
special values on all supported platforms.</p>
</div>
<div class="section" id="api-definition">
<h1><a class="toc-backref" href="#id8">API Definition</a></h1>
<div class="section" id="constants">
<h2><a class="toc-backref" href="#id9">Constants</a></h2>
<dl class="docutils">
<dt>NaN</dt>
<dd>Non-signalling IEEE 754 &quot;Not a Number&quot; value</dd>
<dt>PosInf</dt>
<dd>IEEE 754 Positive Infinity value</dd>
<dt>NegInf</dt>
<dd>IEEE 754 Negative Infinity value</dd>
</dl>
</div>
<div class="section" id="functions">
<h2><a class="toc-backref" href="#id10">Functions</a></h2>
<dl class="docutils">
<dt>isNaN(value)</dt>
<dd>Determine if the argument is an IEEE 754 NaN (Not a Number) value.</dd>
<dt>isPosInf(value)</dt>
<dd>Determine if the argument is an IEEE 754 positive infinity value.</dd>
<dt>isNegInf(value)</dt>
<dd>Determine if the argument is an IEEE 754 negative infinity value.</dd>
<dt>isFinite(value)</dt>
<dd>Determine if the argument is a finite IEEE 754 value (i.e., is
not NaN, positive, or negative infinity).</dd>
<dt>isInf(value)</dt>
<dd>Determine if the argument is an infinite IEEE 754 value (positive
or negative infinity)</dd>
</dl>
</div>
<div class="section" id="example">
<h2><a class="toc-backref" href="#id11">Example</a></h2>
<p>(Run under Python 2.2.1 on Solaris 8.)</p>
<pre class="doctest-block">
&gt;&gt;&gt; import fpconst
&gt;&gt;&gt; val = 1e30000 # should be cause overflow and result in &quot;Inf&quot;
&gt;&gt;&gt; val
Infinity
&gt;&gt;&gt; fpconst.isInf(val)
1
&gt;&gt;&gt; fpconst.PosInf
Infinity
&gt;&gt;&gt; nval = val/val # should result in NaN
&gt;&gt;&gt; nval
NaN
&gt;&gt;&gt; fpconst.isNaN(nval)
1
&gt;&gt;&gt; fpconst.isNaN(val)
0
</pre>
</div>
<div class="section" id="implementation">
<h2><a class="toc-backref" href="#id12">Implementation</a></h2>
<p>The reference implementation is provided in the module &quot;fpconst&quot; <a class="footnote-reference" href="#id3" id="id1">[1]</a>,
which is written in pure Python by taking advantage of the &quot;struct&quot;
standard module to directly set or test for the bit patterns that
define IEEE 754 special values.  Care has been taken to generate
proper results on both big-endian and little-endian machines.  The
current implementation is pure Python, but some efficiency could be
gained by translating the core routines into C.</p>
<p>Patch 1151323 &quot;New fpconst module&quot; <a class="footnote-reference" href="#id4" id="id2">[2]</a> on SourceForge adds the
fpconst module to the Python standard library.</p>
</div>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id13">References</a></h1>
<p>See <a class="reference external" href="http://babbage.cs.qc.edu/courses/cs341/IEEE-754references.html">http://babbage.cs.qc.edu/courses/cs341/IEEE-754references.html</a> for
reference material on the IEEE 754 floating point standard.</p>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Further information on the reference package is available at
<a class="reference external" href="http://research.warnes.net/projects/rzope/fpconst/">http://research.warnes.net/projects/rzope/fpconst/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="http://sourceforge.net/tracker/?func=detail&amp;aid=1151323&amp;group_id=5470&amp;atid=305470">http://sourceforge.net/tracker/?func=detail&amp;aid=1151323&amp;group_id=5470&amp;atid=305470</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id14">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
End: -->
</div>


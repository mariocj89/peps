<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">515</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Underscores in Numeric Literals</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0515.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Georg Brandl, Serhiy Storchaka</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Final</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">10-Feb-2016</td>
</tr>
<tr class="field"><th class="field-name">Python-Version:</th><td class="field-body">3.6</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">10-Feb-2016, 11-Feb-2016</td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract-and-rationale" id="id26">Abstract and Rationale</a></li>
<li><a class="reference internal" href="#specification" id="id27">Specification</a><ul>
<li><a class="reference internal" href="#literal-grammar" id="id28">Literal Grammar</a></li>
<li><a class="reference internal" href="#constructors" id="id29">Constructors</a></li>
<li><a class="reference internal" href="#further-changes" id="id30">Further changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#prior-art" id="id31">Prior Art</a></li>
<li><a class="reference internal" href="#alternative-syntax" id="id32">Alternative Syntax</a><ul>
<li><a class="reference internal" href="#underscore-placement-rules" id="id33">Underscore Placement Rules</a></li>
<li><a class="reference internal" href="#different-separators" id="id34">Different Separators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation" id="id35">Implementation</a></li>
<li><a class="reference internal" href="#references" id="id36">References</a></li>
<li><a class="reference internal" href="#copyright" id="id37">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract-and-rationale">
<h1><a class="toc-backref" href="#id26">Abstract and Rationale</a></h1>
<p>This PEP proposes to extend Python's syntax and number-from-string
constructors so that underscores can be used as visual separators for
digit grouping purposes in integral, floating-point and complex number
literals.</p>
<p>This is a common feature of other modern languages, and can aid
readability of long literals, or literals whose value should clearly
separate into parts, such as bytes or words in hexadecimal notation.</p>
<p>Examples:</p>
<pre class="literal-block">
# grouping decimal numbers by thousands
amount = 10_000_000.0

# grouping hexadecimal addresses by words
addr = 0xCAFE_F00D

# grouping bits into nibbles in a binary literal
flags = 0b_0011_1111_0100_1110

# same, for string conversions
flags = int('0b_1111_0000', 2)
</pre>
</div>
<div class="section" id="specification">
<h1><a class="toc-backref" href="#id27">Specification</a></h1>
<p>The current proposal is to allow one underscore between digits, and
after base specifiers in numeric literals.  The underscores have no
semantic meaning, and literals are parsed as if the underscores were
absent.</p>
<div class="section" id="literal-grammar">
<h2><a class="toc-backref" href="#id28">Literal Grammar</a></h2>
<p>The production list for integer literals would therefore look like
this:</p>
<pre class="literal-block">
integer: decinteger | bininteger | octinteger | hexinteger
decinteger: nonzerodigit ([&quot;_&quot;] digit)* | &quot;0&quot; ([&quot;_&quot;] &quot;0&quot;)*
bininteger: &quot;0&quot; (&quot;b&quot; | &quot;B&quot;) ([&quot;_&quot;] bindigit)+
octinteger: &quot;0&quot; (&quot;o&quot; | &quot;O&quot;) ([&quot;_&quot;] octdigit)+
hexinteger: &quot;0&quot; (&quot;x&quot; | &quot;X&quot;) ([&quot;_&quot;] hexdigit)+
nonzerodigit: &quot;1&quot;...&quot;9&quot;
digit: &quot;0&quot;...&quot;9&quot;
bindigit: &quot;0&quot; | &quot;1&quot;
octdigit: &quot;0&quot;...&quot;7&quot;
hexdigit: digit | &quot;a&quot;...&quot;f&quot; | &quot;A&quot;...&quot;F&quot;
</pre>
<p>For floating-point and complex literals:</p>
<pre class="literal-block">
floatnumber: pointfloat | exponentfloat
pointfloat: [digitpart] fraction | digitpart &quot;.&quot;
exponentfloat: (digitpart | pointfloat) exponent
digitpart: digit ([&quot;_&quot;] digit)*
fraction: &quot;.&quot; digitpart
exponent: (&quot;e&quot; | &quot;E&quot;) [&quot;+&quot; | &quot;-&quot;] digitpart
imagnumber: (floatnumber | digitpart) (&quot;j&quot; | &quot;J&quot;)
</pre>
</div>
<div class="section" id="constructors">
<h2><a class="toc-backref" href="#id29">Constructors</a></h2>
<p>Following the same rules for placement, underscores will be allowed in
the following constructors:</p>
<ul class="simple">
<li><tt class="docutils literal">int()</tt> (with any base)</li>
<li><tt class="docutils literal">float()</tt></li>
<li><tt class="docutils literal">complex()</tt></li>
<li><tt class="docutils literal">Decimal()</tt></li>
</ul>
</div>
<div class="section" id="further-changes">
<h2><a class="toc-backref" href="#id30">Further changes</a></h2>
<p>The new-style number-to-string formatting language will be extended to
allow <tt class="docutils literal">_</tt> as a thousands separator, where currently only <tt class="docutils literal">,</tt> is
supported.  This can be used to easily generate code with more
readable literals.  <a class="footnote-reference" href="#id24" id="id1">[11]</a></p>
<p>The syntax would be the same as for the comma, e.g. <tt class="docutils literal">{:10_}</tt> for a
width of 10 with <tt class="docutils literal">_</tt> separator.</p>
<p>For the <tt class="docutils literal">b</tt>, <tt class="docutils literal">x</tt> and <tt class="docutils literal">o</tt> format specifiers, <tt class="docutils literal">_</tt> will be
allowed and group by 4 digits.</p>
</div>
</div>
<div class="section" id="prior-art">
<h1><a class="toc-backref" href="#id31">Prior Art</a></h1>
<p>Those languages that do allow underscore grouping implement a large
variety of rules for allowed placement of underscores.  In cases where
the language spec contradicts the actual behavior, the actual behavior
is listed.  (&quot;single&quot; or &quot;multiple&quot; refer to allowing runs of
consecutive underscores.)</p>
<ul class="simple">
<li>Ada: single, only between digits <a class="footnote-reference" href="#id21" id="id2">[8]</a></li>
<li>C# (open proposal for 7.0): multiple, only between digits <a class="footnote-reference" href="#id19" id="id3">[6]</a></li>
<li>C++14: single, between digits (different separator chosen) <a class="footnote-reference" href="#id14" id="id4">[1]</a></li>
<li>D: multiple, anywhere, including trailing <a class="footnote-reference" href="#id15" id="id5">[2]</a></li>
<li>Java: multiple, only between digits <a class="footnote-reference" href="#id20" id="id6">[7]</a></li>
<li>Julia: single, only between digits (but not in float exponent parts)
<a class="footnote-reference" href="#id22" id="id7">[9]</a></li>
<li>Perl 5: multiple, basically anywhere, although docs say it's
restricted to one underscore between digits <a class="footnote-reference" href="#id16" id="id8">[3]</a></li>
<li>Ruby: single, only between digits (although docs say &quot;anywhere&quot;)
<a class="footnote-reference" href="#id23" id="id9">[10]</a></li>
<li>Rust: multiple, anywhere, except for between exponent &quot;e&quot; and digits
<a class="footnote-reference" href="#id17" id="id10">[4]</a></li>
<li>Swift: multiple, between digits and trailing (although textual
description says only &quot;between digits&quot;) <a class="footnote-reference" href="#id18" id="id11">[5]</a></li>
</ul>
</div>
<div class="section" id="alternative-syntax">
<h1><a class="toc-backref" href="#id32">Alternative Syntax</a></h1>
<div class="section" id="underscore-placement-rules">
<h2><a class="toc-backref" href="#id33">Underscore Placement Rules</a></h2>
<p>Instead of the relatively strict rule specified above, the use of
underscores could be less limited.  As seen in other languages, common
rules include:</p>
<ul class="simple">
<li>Only one consecutive underscore allowed, and only between digits.</li>
<li>Multiple consecutive underscores allowed, but only between digits.</li>
<li>Multiple consecutive underscores allowed, in most positions except
for the start of the literal, or special positions like after a
decimal point.</li>
</ul>
<p>The syntax in this PEP has ultimately been selected because it covers
the common use cases, and does not allow for syntax that would have to
be discouraged in style guides anyway.</p>
<p>A less common rule would be to allow underscores only every N digits
(where N could be 3 for decimal literals, or 4 for hexadecimal ones).
This is unnecessarily restrictive, especially considering the
separator placement is different in different cultures.</p>
</div>
<div class="section" id="different-separators">
<h2><a class="toc-backref" href="#id34">Different Separators</a></h2>
<p>A proposed alternate syntax was to use whitespace for grouping.
Although strings are a precedent for combining adjoining literals, the
behavior can lead to unexpected effects which are not possible with
underscores.  Also, no other language is known to use this rule,
except for languages that generally disregard any whitespace.</p>
<p>C++14 introduces apostrophes for grouping (because underscores
introduce ambiguity with user-defined literals), which is not
considered because of the use in Python's string literals. <a class="footnote-reference" href="#id14" id="id12">[1]</a></p>
</div>
</div>
<div class="section" id="implementation">
<h1><a class="toc-backref" href="#id35">Implementation</a></h1>
<p>A preliminary patch that implements the specification given above has
been posted to the issue tracker. <a class="footnote-reference" href="#id25" id="id13">[12]</a></p>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id36">References</a></h1>
<table class="docutils footnote" frame="void" id="id14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id4">1</a>, <a class="fn-backref" href="#id12">2</a>)</em> <a class="reference external" href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3499.html">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3499.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id15" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[2]</a></td><td><a class="reference external" href="http://dlang.org/spec/lex.html#integerliteral">http://dlang.org/spec/lex.html#integerliteral</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id16" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[3]</a></td><td><a class="reference external" href="http://perldoc.perl.org/perldata.html#Scalar-value-constructors">http://perldoc.perl.org/perldata.html#Scalar-value-constructors</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id17" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[4]</a></td><td><a class="reference external" href="http://doc.rust-lang.org/reference.html#number-literals">http://doc.rust-lang.org/reference.html#number-literals</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id18" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11">[5]</a></td><td><a class="reference external" href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/LexicalStructure.html">https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/LexicalStructure.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id19" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[6]</a></td><td><a class="reference external" href="https://github.com/dotnet/roslyn/issues/216">https://github.com/dotnet/roslyn/issues/216</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id20" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[7]</a></td><td><a class="reference external" href="https://docs.oracle.com/javase/7/docs/technotes/guides/language/underscores-literals.html">https://docs.oracle.com/javase/7/docs/technotes/guides/language/underscores-literals.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id21" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[8]</a></td><td><a class="reference external" href="http://archive.adaic.com/standards/83lrm/html/lrm-02-04.html#2.4">http://archive.adaic.com/standards/83lrm/html/lrm-02-04.html#2.4</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id22" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[9]</a></td><td><a class="reference external" href="http://docs.julialang.org/en/release-0.4/manual/integers-and-floating-point-numbers/">http://docs.julialang.org/en/release-0.4/manual/integers-and-floating-point-numbers/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id23" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[10]</a></td><td><a class="reference external" href="http://ruby-doc.org/core-2.3.0/doc/syntax/literals_rdoc.html#label-Numbers">http://ruby-doc.org/core-2.3.0/doc/syntax/literals_rdoc.html#label-Numbers</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id24" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[11]</a></td><td><a class="reference external" href="https://mail.python.org/pipermail/python-dev/2016-February/143283.html">https://mail.python.org/pipermail/python-dev/2016-February/143283.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id25" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id13">[12]</a></td><td><a class="reference external" href="http://bugs.python.org/issue26331">http://bugs.python.org/issue26331</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id37">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
coding: utf-8
End: -->
</div>


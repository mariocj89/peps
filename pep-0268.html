<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">268</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Extended HTTP functionality and WebDAV</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0268.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">gstein&#32;&#97;t&#32;lyra.org (Greg Stein)</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Rejected</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">20-Aug-2001</td>
</tr>
<tr class="field"><th class="field-name">Python-Version:</th><td class="field-body">2.x</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">21-Aug-2001</td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#rejection-notice" id="id3">Rejection Notice</a></li>
<li><a class="reference internal" href="#abstract" id="id4">Abstract</a></li>
<li><a class="reference internal" href="#rationale" id="id5">Rationale</a></li>
<li><a class="reference internal" href="#specification" id="id6">Specification</a><ul>
<li><a class="reference internal" href="#http-authentication" id="id7">HTTP Authentication</a></li>
<li><a class="reference internal" href="#proxy-handling" id="id8">Proxy Handling</a></li>
<li><a class="reference internal" href="#webdav-features" id="id9">WebDAV Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reference-implementation" id="id10">Reference Implementation</a></li>
<li><a class="reference internal" href="#references" id="id11">References</a></li>
<li><a class="reference internal" href="#copyright" id="id12">Copyright</a></li>
</ul>
</div>
<div class="section" id="rejection-notice">
<h1><a class="toc-backref" href="#id3">Rejection Notice</a></h1>
<p>This PEP has been rejected. It has failed to generate sufficient
community support in the six years since its proposal.</p>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id4">Abstract</a></h1>
<p>This PEP discusses new modules and extended functionality for Python's
HTTP support. Notably, the addition of authenticated requests, proxy
support, authenticated proxy usage, and <a class="reference external" href="http://www.webdav.org/">WebDAV</a> <a class="footnote-reference" href="#id1" id="id2">[1]</a> capabilities.</p>
</div>
<div class="section" id="rationale">
<h1><a class="toc-backref" href="#id5">Rationale</a></h1>
<p>Python has been quite popular as a result of its &quot;batteries included&quot;
positioning. One of the most heavily used protocols, HTTP (see <a class="reference external" href="http://tools.ietf.org/html/rfc2616.html">RFC
2616</a>), has been included with Python for years (<tt class="docutils literal">httplib</tt>). However,
this support has not kept up with the full needs and requirements of
many HTTP-based applications and systems. In addition, new protocols
based on HTTP, such as WebDAV and XML-RPC, are becoming useful and are
seeing increasing usage. Supplying this functionality meets Python's
&quot;batteries included&quot; role and also keeps Python at the leading edge of
new technologies.</p>
<p>While authentication and proxy support are two very notable features
missing from Python's core HTTP processing, they are minimally handled
as part of Python's URL handling (<tt class="docutils literal">urllib</tt> and
<tt class="docutils literal">urllib2</tt>). However, applications that need fine-grained or
sophisticated HTTP handling cannot make use of the features while they
reside in urllib. Refactoring these features into a location where
they can be directly associated with an HTTP connection will improve
their utility for both urllib and for sophisticated applications.</p>
<p>The motivation for this PEP was from several people requesting these
features directly, and from a number of feature requests on
SourceForge. Since the exact form of the modules to be provided and
the classes/architecture used could be subject to debate, this PEP was
created to provide a focal point for those discussions.</p>
</div>
<div class="section" id="specification">
<h1><a class="toc-backref" href="#id6">Specification</a></h1>
<p>Two modules will be added to the standard library: <tt class="docutils literal">httpx</tt> (HTTP
extended functionality), and <tt class="docutils literal">davlib</tt> (WebDAV library).</p>
<p>[ suggestions for module names are welcome; <tt class="docutils literal">davlib</tt> has some
precedence, but something like <tt class="docutils literal">webdav</tt> might be desirable ]</p>
<div class="section" id="http-authentication">
<h2><a class="toc-backref" href="#id7">HTTP Authentication</a></h2>
<p>The <tt class="docutils literal">httpx</tt> module will provide a mixin for performing HTTP
authentication (for both proxy and origin server authentication). This
mixin (<tt class="docutils literal">httpx.HandleAuthentication</tt>) can be combined with the
<tt class="docutils literal">HTTPConnection</tt> and the <tt class="docutils literal">HTTPSConnection</tt> classes (the mixin may
possibly work with the HTTP and HTTPS compatibility classes, but that
is not a requirement).</p>
<p>The mixin will delegate the authentication process to one or more
&quot;authenticator&quot; objects, allowing multiple connections to share
authenticators. The use of a separate object allows for a long term
connection to an authentication system (e.g. LDAP). An authenticator
for the Basic and Digest mechanisms (see <a class="reference external" href="http://tools.ietf.org/html/rfc2617.html">RFC 2617</a>) will be
provided. User-supplied authenticator subclasses can be registered and
used by the connections.</p>
<p>A &quot;credentials&quot; object (<tt class="docutils literal">httpx.Credentials</tt>) is also associated with
the mixin, and stores the credentials (e.g. username and password)
needed by the authenticators. Subclasses of Credentials can be created
to hold additional information (e.g. NT domain).</p>
<p>The mixin overrides the <tt class="docutils literal">getresponse()</tt> method to detect <tt class="docutils literal">401
(Unauthorized)</tt> and <tt class="docutils literal">407 (Proxy Authentication Required)</tt>
responses. When this is found, the response object, the connection,
and the credentials are passed to the authenticator corresponding with
the authentication scheme specified in the response (multiple
authenticators are tried in decreasing order of security if multiple
schemes are in the response). Each authenticator can examine the
response headers and decide whether and how to resend the request with
the correct authentication headers. If no authenticator can
successfully handle the authentication, then an exception is raised.</p>
<p>Resending a request, with the appropriate credentials, is one of the
more difficult portions of the authentication system. The difficulty
arises in recording what was sent originally: the request line, the
headers, and the body. By overriding putrequest, putheader, and
endheaders, we can capture all but the body. Once the endheaders
method is called, then we capture all calls to send() (until the next
putrequest method call) to hold the body content. The mixin will have
a configurable limit for the amount of data to hold in this fashion
(e.g. only hold up to 100k of body content). Assuming that the entire
body has been stored, then we can resend the request with the
appropriate authentication information.</p>
<p>If the body is too large to be stored, then the <tt class="docutils literal">getresponse()</tt>
simply returns the response object, indicating the 401 or 407
error. Since the authentication information has been computed and
cached (into the Credentials object; see below), the caller can simply
regenerate the request. The mixin will attach the appropriate
credentials.</p>
<p>A &quot;protection space&quot; (see <a class="reference external" href="http://tools.ietf.org/html/rfc2617.html">RFC 2617</a>, section 1.2) is defined as a tuple
of the host, port, and authentication realm. When a request is
initially sent to an HTTP server, we do not know the authentication
realm (the realm is only returned when authentication fails). However,
we do have the path from the URL, and that can be useful in
determining the credentials to send to the server.  The Basic
authentication scheme is typically set up hierarchically: the
credentials for <tt class="docutils literal">/path</tt> can be tried for <tt class="docutils literal">/path/subpath</tt>. The
Digest authentication scheme has explicit support for the hierarchical
setup. The <tt class="docutils literal">httpx.Credentials</tt> object will store credentials for
multiple protection spaces, and can be looked up in two different
ways:</p>
<ol class="arabic simple">
<li>looked up using <tt class="docutils literal">(host, port, path)</tt> -- this lookup scheme is
used when generating a request for a path where we don't know the
authentication realm.</li>
<li>looked up using <tt class="docutils literal">(host, port, realm)</tt> -- this mechanism is used
during the authentication process when the server has specified that
the Request-URI resides within a specific realm.</li>
</ol>
<p>The <tt class="docutils literal">HandleAuthentication</tt> mixin will override <tt class="docutils literal">putrequest()</tt> to
automatically insert credentials, if available. The URL from the
putrequest is used to determine the appropriate authentication
information to use.</p>
<p>It is also important to note that two sets of credentials are used,
and stored by the mixin. One set for any proxy that may be used, and
one used for the target origin server. Since proxies do not have
paths, the protection spaces in the proxy credentials will always use
&quot;/&quot; for storing and looking up via a path.</p>
</div>
<div class="section" id="proxy-handling">
<h2><a class="toc-backref" href="#id8">Proxy Handling</a></h2>
<p>The <tt class="docutils literal">httpx</tt> module will provide a mixin for using a proxy to perform
HTTP(S) operations. This mixin (<tt class="docutils literal">httpx.UseProxy</tt>) can be combined
with the <tt class="docutils literal">HTTPConnection</tt> and the <tt class="docutils literal">HTTPSConnection</tt> classes (the
mixin may possibly work with the HTTP and HTTPS compatibility classes,
but that is not a requirement).</p>
<p>The mixin will record the <tt class="docutils literal">(host, port)</tt> of the proxy to use. XXX
will be overridden to use this host/port combination for connections
and to rewrite request URLs into the absoluteURIs referring to the
origin server (these URIs are passed to the proxy server).</p>
<p>Proxy authentication is handled by the <tt class="docutils literal">httpx.HandleAuthentication</tt>
class since a user may directly use <tt class="docutils literal">HTTP(S)Connection</tt> to speak
with proxies.</p>
</div>
<div class="section" id="webdav-features">
<h2><a class="toc-backref" href="#id9">WebDAV Features</a></h2>
<p>The <tt class="docutils literal">davlib</tt> module will provide a mixin for sending WebDAV requests
to a WebDAV-enabled server. This mixin (<tt class="docutils literal">davlib.DAVClient</tt>) can be
combined with the <tt class="docutils literal">HTTPConnection</tt> and the <tt class="docutils literal">HTTPSConnection</tt>
classes (the mixin may possibly work with the HTTP and HTTPS
compatibility classes, but that is not a requirement).</p>
<p>The mixin provides methods to perform the various HTTP methods defined
by HTTP in <a class="reference external" href="http://tools.ietf.org/html/rfc2616.html">RFC 2616</a>, and by WebDAV in <a class="reference external" href="http://tools.ietf.org/html/rfc2518.html">RFC 2518</a>.</p>
<p>A custom response object is used to decode <tt class="docutils literal">207 <span class="pre">(Multi-Status)</span></tt>
responses. The response object will use the standard library's xml
package to parse the multistatus XML information, producing a simple
structure of objects to hold the multistatus data. Multiple parsing
schemes will be tried/used, in order of decreasing speed.</p>
</div>
</div>
<div class="section" id="reference-implementation">
<h1><a class="toc-backref" href="#id10">Reference Implementation</a></h1>
<p>The actual (future/final) implementation is being developed in the
<tt class="docutils literal">/nondist/sandbox/Lib</tt> directory, until it is accepted and moved
into the main Lib directory.</p>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id11">References</a></h1>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td><a class="reference external" href="http://www.webdav.org/">http://www.webdav.org/</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id12">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
fill-column: 70
sentence-end-double-space: t
End: -->
</div>


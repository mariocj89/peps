<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">3112</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Bytes literals in Python 3000</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-3112.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Jason Orendorff &lt;jason.orendorff&#32;&#97;t&#32;gmail.com&gt;</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Final</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Requires:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0358">358</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">23-Feb-2007</td>
</tr>
<tr class="field"><th class="field-name">Python-Version:</th><td class="field-body">3.0</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">23-Feb-2007</td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id5">Abstract</a></li>
<li><a class="reference internal" href="#motivation" id="id6">Motivation</a></li>
<li><a class="reference internal" href="#grammar-changes" id="id7">Grammar Changes</a></li>
<li><a class="reference internal" href="#semantics" id="id8">Semantics</a></li>
<li><a class="reference internal" href="#rationale" id="id9">Rationale</a></li>
<li><a class="reference internal" href="#reference-implementation" id="id10">Reference Implementation</a></li>
<li><a class="reference internal" href="#references" id="id11">References</a></li>
<li><a class="reference internal" href="#copyright" id="id12">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id5">Abstract</a></h1>
<p>This PEP proposes a literal syntax for the <tt class="docutils literal">bytes</tt> objects
introduced in <a class="reference external" href="/dev/peps/pep-0358">PEP 358</a>.  The purpose is to provide a convenient way to
spell ASCII strings and arbitrary binary data.</p>
</div>
<div class="section" id="motivation">
<h1><a class="toc-backref" href="#id6">Motivation</a></h1>
<p>Existing spellings of an ASCII string in Python 3000 include:</p>
<pre class="literal-block">
bytes('Hello world', 'ascii')
'Hello world'.encode('ascii')
</pre>
<p>The proposed syntax is:</p>
<pre class="literal-block">
b'Hello world'
</pre>
<p>Existing spellings of an 8-bit binary sequence in Python 3000 include:</p>
<pre class="literal-block">
bytes([0x7f, 0x45, 0x4c, 0x46, 0x01, 0x01, 0x01, 0x00])
bytes('\x7fELF\x01\x01\x01\0', 'latin-1')
'7f454c4601010100'.decode('hex')
</pre>
<p>The proposed syntax is:</p>
<pre class="literal-block">
b'\x7f\x45\x4c\x46\x01\x01\x01\x00'
b'\x7fELF\x01\x01\x01\0'
</pre>
<p>In both cases, the advantages of the new syntax are brevity, some
small efficiency gain, and the detection of encoding errors at compile
time rather than at runtime.  The brevity benefit is especially felt
when using the string-like methods of bytes objects:</p>
<pre class="literal-block">
lines = bdata.split(bytes('\n', 'ascii'))  # existing syntax
lines = bdata.split(b'\n')  # proposed syntax
</pre>
<p>And when converting code from Python 2.x to Python 3000:</p>
<pre class="literal-block">
sok.send('EXIT\r\n')  # Python 2.x
sok.send('EXIT\r\n'.encode('ascii'))  # Python 3000 existing
sok.send(b'EXIT\r\n')  # proposed
</pre>
</div>
<div class="section" id="grammar-changes">
<h1><a class="toc-backref" href="#id7">Grammar Changes</a></h1>
<p>The proposed syntax is an extension of the existing string
syntax <a class="footnote-reference" href="#stringliterals" id="id1">[1]</a>.</p>
<p>The new syntax for strings, including the new bytes literal, is:</p>
<pre class="literal-block">
stringliteral: [stringprefix] (shortstring | longstring)
stringprefix: &quot;b&quot; | &quot;r&quot; | &quot;br&quot; | &quot;B&quot; | &quot;R&quot; | &quot;BR&quot; | &quot;Br&quot; | &quot;bR&quot;
shortstring: &quot;'&quot; shortstringitem* &quot;'&quot; | '&quot;' shortstringitem* '&quot;'
longstring: &quot;'''&quot; longstringitem* &quot;'''&quot; | '&quot;&quot;&quot;' longstringitem* '&quot;&quot;&quot;'
shortstringitem: shortstringchar | escapeseq
longstringitem: longstringchar | escapeseq
shortstringchar:
  &lt;any source character except &quot;\&quot; or newline or the quote&gt;
longstringchar: &lt;any source character except &quot;\&quot;&gt;
escapeseq: &quot;\&quot; NL
  | &quot;\\&quot; | &quot;\'&quot; | '\&quot;'
  | &quot;\a&quot; | &quot;\b&quot; | &quot;\f&quot; | &quot;\n&quot; | &quot;\r&quot; | &quot;\t&quot; | &quot;\v&quot;
  | &quot;\ooo&quot; | &quot;\xhh&quot;
  | &quot;\uxxxx&quot; | &quot;\Uxxxxxxxx&quot; | &quot;\N{name}&quot;
</pre>
<p>The following additional restrictions apply only to bytes literals
(<tt class="docutils literal">stringliteral</tt> tokens with <tt class="docutils literal">b</tt> or <tt class="docutils literal">B</tt> in the
<tt class="docutils literal">stringprefix</tt>):</p>
<ul class="simple">
<li>Each <tt class="docutils literal">shortstringchar</tt> or <tt class="docutils literal">longstringchar</tt> must be a character
between 1 and 127 inclusive, regardless of any encoding
declaration <a class="footnote-reference" href="#encodings" id="id2">[2]</a> in the source file.</li>
<li>The Unicode-specific escape sequences <tt class="docutils literal">\u</tt><em>xxxx</em>,
<tt class="docutils literal">\U</tt><em>xxxxxxxx</em>, and <tt class="docutils literal">\N{</tt><em>name</em><tt class="docutils literal">}</tt> are unrecognized in
Python 2.x and forbidden in Python 3000.</li>
</ul>
<p>Adjacent bytes literals are subject to the same concatenation rules as
adjacent string literals <a class="footnote-reference" href="#concat" id="id3">[3]</a>.  A bytes literal adjacent to a
string literal is an error.</p>
</div>
<div class="section" id="semantics">
<h1><a class="toc-backref" href="#id8">Semantics</a></h1>
<p>Each evaluation of a bytes literal produces a new <tt class="docutils literal">bytes</tt> object.
The bytes in the new object are the bytes represented by the
<tt class="docutils literal">shortstringitem</tt> or <tt class="docutils literal">longstringitem</tt> parts of the literal, in the
same order.</p>
</div>
<div class="section" id="rationale">
<h1><a class="toc-backref" href="#id9">Rationale</a></h1>
<p>The proposed syntax provides a cleaner migration path from Python 2.x
to Python 3000 for most code involving 8-bit strings.  Preserving the
old 8-bit meaning of a string literal is usually as simple as adding a
<tt class="docutils literal">b</tt> prefix.  The one exception is Python 2.x strings containing
bytes &gt;127, which must be rewritten using escape sequences.
Transcoding a source file from one encoding to another, and fixing up
the encoding declaration, should preserve the meaning of the program.
Python 2.x non-Unicode strings violate this principle; Python 3000
bytes literals shouldn't.</p>
<p>A string literal with a <tt class="docutils literal">b</tt> in the prefix is always a syntax error
in Python 2.5, so this syntax can be introduced in Python 2.6, along
with the <tt class="docutils literal">bytes</tt> type.</p>
<p>A bytes literal produces a new object each time it is evaluated, like
list displays and unlike string literals.  This is necessary because
bytes literals, like lists and unlike strings, are
mutable <a class="footnote-reference" href="#eachnew" id="id4">[4]</a>.</p>
</div>
<div class="section" id="reference-implementation">
<h1><a class="toc-backref" href="#id10">Reference Implementation</a></h1>
<p>Thomas Wouters has checked an implementation into the Py3K branch,
r53872.</p>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id11">References</a></h1>
<table class="docutils footnote" frame="void" id="stringliterals" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="http://docs.python.org/reference/lexical_analysis.html#string-literals">http://docs.python.org/reference/lexical_analysis.html#string-literals</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="encodings" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="http://docs.python.org/reference/lexical_analysis.html#encoding-declarations">http://docs.python.org/reference/lexical_analysis.html#encoding-declarations</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="concat" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><a class="reference external" href="http://docs.python.org/reference/lexical_analysis.html#string-literal-concatenation">http://docs.python.org/reference/lexical_analysis.html#string-literal-concatenation</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="eachnew" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td><a class="reference external" href="https://mail.python.org/pipermail/python-3000/2007-February/005779.html">https://mail.python.org/pipermail/python-3000/2007-February/005779.html</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id12">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
</div>


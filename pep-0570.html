<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">570</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Python Positional-Only Parameters</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0570.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Larry Hastings &lt;larry&#32;&#97;t&#32;hastings.org&gt;,
Pablo Galindo &lt;pablogsal&#32;&#97;t&#32;gmail.com&gt;,
Mario Corchero &lt;mariocj89&#32;&#97;t&#32;gmail.com&gt;</td>
</tr>
<tr class="field"><th class="field-name">Discussions-To:</th><td class="field-body">Python-Dev &lt;<a class="reference external" href="mailto:python-dev&#64;python.org?subject=PEP%20570">python-dev&#32;&#97;t&#32;python.org</a>&gt;</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Draft</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">20-Jan-2018</td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id11">Overview</a></li>
<li><a class="reference internal" href="#rationale" id="id12">Rationale</a><ul>
<li><a class="reference internal" href="#positional-only-parameter-semantics-in-current-python" id="id13">Positional-Only Parameter Semantics In Current Python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#motivation" id="id14">Motivation</a></li>
<li><a class="reference internal" href="#the-current-state-of-documentation-for-positional-only-parameters" id="id15">The Current State Of Documentation For Positional-Only Parameters</a></li>
<li><a class="reference internal" href="#syntax-and-semantics" id="id16">Syntax And Semantics</a></li>
<li><a class="reference internal" href="#full-grammar-specification" id="id17">Full grammar specification</a></li>
<li><a class="reference internal" href="#implementation-plan" id="id18">Implementation Plan</a></li>
<li><a class="reference internal" href="#rejected-ideas" id="id19">Rejected Ideas</a><ul>
<li><a class="reference internal" href="#do-nothing" id="id20">Do Nothing</a></li>
<li><a class="reference internal" href="#after-marker-proposal" id="id21">After marker proposal</a></li>
<li><a class="reference internal" href="#per-argument-marker" id="id22">Per-argument marker</a></li>
<li><a class="reference internal" href="#using-decorators" id="id23">Using decorators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#thanks" id="id24">Thanks</a></li>
<li><a class="reference internal" href="#copyright" id="id25">Copyright</a></li>
</ul>
</div>
<div class="section" id="overview">
<h1><a class="toc-backref" href="#id11">Overview</a></h1>
<p>This PEP proposes a syntax for positional-only parameters in Python.
Positional-only parameters are parameters without an externally-usable
name; when a function accepting positional-only parameters is called,
positional arguments are mapped to these parameters based solely on
their position.</p>
</div>
<div class="section" id="rationale">
<h1><a class="toc-backref" href="#id12">Rationale</a></h1>
<p>Python has always supported positional-only parameters.
Early versions of Python lacked the concept of specifying
parameters by name, so naturally all parameters were
positional-only.  This changed around Python 1.0, when
all parameters suddenly became positional-or-keyword.
This allowed users to provide arguments to a function both
positionally or referencing the keyword used in the definition
of it. But, this is not always desired nor even available as
even in current versions of Python, many CPython
&quot;builtin&quot; functions still only accept positional-only arguments.</p>
<p>Even if positional arguments only in a function can be achieved
via using <tt class="docutils literal">*args</tt> parameters and extracting them one by one,
the solution is far from ideal and not as expressive as the one
proposed in this PEP, which targets to provide syntax to specify
accepting a specific number of positional-only parameters.
Additionally, this will bridge the gap we currently find between
builtin functions that today allows to specify positional-only
parameters and pure Python implementations that lack the
syntax for it.</p>
<div class="section" id="positional-only-parameter-semantics-in-current-python">
<h2><a class="toc-backref" href="#id13">Positional-Only Parameter Semantics In Current Python</a></h2>
<p>There are many, many examples of builtins that only
accept positional-only parameters.  The resulting
semantics are easily experienced by the Python
programmer--just try calling one, specifying its
arguments by name:</p>
<pre class="literal-block">
&gt;&gt;&gt; help(pow)
...
pow(x, y, z=None, /)
...
&gt;&gt;&gt; pow(x=5, y=3)
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
TypeError: pow() takes no keyword arguments
</pre>
<p>Pow clearly expresses that its arguments are only positional
via the <tt class="docutils literal">/</tt> marker, but this is at the moment only documentational,
Python developers cannot write such syntax.</p>
<p>In addition, there are some functions with particularly
interesting semantics:</p>
<ul class="simple">
<li><tt class="docutils literal">range()</tt>, which accepts an optional parameter
to the <em>left</em> of its required parameter. <a class="footnote-reference" href="#range" id="id1">[2]</a></li>
<li><tt class="docutils literal">dict()</tt>, whose mapping/iterator parameter is optional and
semantically must be positional-only.  Any externally
visible name for this parameter would occlude
that name going into the <tt class="docutils literal">**kwarg</tt> keyword variadic
parameter dict! <a class="footnote-reference" href="#dict" id="id2">[1]</a></li>
</ul>
<p>Obviously one can simulate any of these in pure Python code
by accepting <tt class="docutils literal">(*args, **kwargs)</tt> and parsing the arguments
by hand.  But this results in a disconnect between the
Python function signature and what it actually accepts,
not to mention the work of implementing said argument parsing.</p>
</div>
</div>
<div class="section" id="motivation">
<h1><a class="toc-backref" href="#id14">Motivation</a></h1>
<p>The new syntax will allow developers to further control how their
API can be consumed. It will allow restricting the usage of keyword
Specify arguments by adding the new type of positional-only ones.</p>
<p>A similar PEP with a broader scope (<a class="reference external" href="/dev/peps/pep-0457">PEP 457</a>) was proposed
to define the syntax. This PEP builds on top of part of it
to define and provide an implementation for the <tt class="docutils literal">/</tt> syntax on
function signatures.</p>
</div>
<div class="section" id="the-current-state-of-documentation-for-positional-only-parameters">
<h1><a class="toc-backref" href="#id15">The Current State Of Documentation For Positional-Only Parameters</a></h1>
<p>The documentation for positional-only parameters is incomplete
and inconsistent:</p>
<ul class="simple">
<li>Some functions denote optional groups of positional-only arguments
by enclosing them in nested square brackets. <a class="footnote-reference" href="#border" id="id3">[3]</a></li>
<li>Some functions denote optional groups of positional-only arguments
by presenting multiple prototypes with varying numbers of
arguments. <a class="footnote-reference" href="#sendfile" id="id4">[4]</a></li>
<li>Some functions use <em>both</em> of the above approaches. <a class="footnote-reference" href="#range" id="id5">[2]</a> <a class="footnote-reference" href="#addch" id="id6">[5]</a></li>
</ul>
<p>One more important idea to consider: currently in the documentation
there's no way to tell whether a function takes positional-only
parameters.  <tt class="docutils literal">open()</tt> accepts keyword arguments, <tt class="docutils literal">ord()</tt> does
not, but there is no way of telling just by reading the
documentation that this is true.</p>
</div>
<div class="section" id="syntax-and-semantics">
<h1><a class="toc-backref" href="#id16">Syntax And Semantics</a></h1>
<p>From the &quot;ten-thousand foot view&quot;, and ignoring <tt class="docutils literal">*args</tt> and <tt class="docutils literal">**kwargs</tt>
for now, the grammar for a function definition currently looks like this:</p>
<pre class="literal-block">
def name(positional_or_keyword_parameters, *, keyword_only_parameters):
</pre>
<p>Building on that perspective, the new syntax for functions would look
like this:</p>
<pre class="literal-block">
def name(positional_only_parameters, /, positional_or_keyword_parameters,
         *, keyword_only_parameters):
</pre>
<p>All parameters before the <tt class="docutils literal">/</tt> are positional-only.  If <tt class="docutils literal">/</tt> is
not specified in a function signature, that function does not
accept any positional-only parameters.
The logic around optional values for positional-only argument
Remains the same as the one for positional-or-keyword. Once
a positional-only argument is provided with a default,
the following positional-only and positional-or-keyword argument
need to have a default as well. Positional-only parameters that
don’t have a default value are &quot;required&quot; positional-only parameters.
Therefore the following are valid signatures:</p>
<pre class="literal-block">
def name(p1, p2, /, p_or_kw, *, kw):
def name(p1, p2=None, /, p_or_kw=None, *, kw):
def name(p1, p2=None, /, *, kw):
def name(p1, p2=None, /):
def name(p1, p2, /, p_or_kw):
def name(p1, p2, /):
</pre>
<p>Whilst the followings are not:</p>
<pre class="literal-block">
def name(p1, p2=None, /, p_or_kw, *, kw):
def name(p1=None, p2, /, p_or_kw=None, *, kw):
def name(p1=None, p2, /):
</pre>
</div>
<div class="section" id="full-grammar-specification">
<h1><a class="toc-backref" href="#id17">Full grammar specification</a></h1>
<p>A draft of the proposed grammar specification is:</p>
<pre class="literal-block">
new_typedargslist:
  tfpdef (',' tfpdef)* ',' '/' [',' [typedargslist]] | typedargslist

new_varargslist:
  vfpdef (',' vfpdef)* ',' '/' [',' [varargslist]] | varargslist
</pre>
<p>It will be added to the actual typedargslist and varargslist
but for easier discussion is presented as new_typedargslist and new_varargslist</p>
</div>
<div class="section" id="implementation-plan">
<h1><a class="toc-backref" href="#id18">Implementation Plan</a></h1>
<p>The implementation will involve a full change of the Grammar. This will
involve following the steps outlined in <a class="reference external" href="/dev/peps/pep-0306">PEP 306</a> <a class="footnote-reference" href="#pep306" id="id7">[7]</a>. In addition, other
steps are needed including:</p>
<ul class="simple">
<li>Modifying the code object and the function object to be aware of positional
only arguments.</li>
<li>Modifiying <tt class="docutils literal">ceval.c</tt> (<tt class="docutils literal">PyEval_EvalCodeEx</tt>, <tt class="docutils literal">PyEval_EvalFrameEx</tt>...)
to correctly handle positional-only arguments.</li>
<li>Modifying <tt class="docutils literal">marshal.c</tt> to account for the modifications of the code object.</li>
</ul>
<p>This does not intend to be a guide or a comprehensive recipe on how to implement
this but a rough outline of the changes this will make to the codebase.</p>
<p>The advantages of this implementation involve speed, consistency with the
implementation of keyword-only parameters as in <a class="reference external" href="/dev/peps/pep-3102">PEP 3102</a> and a simpler implementation
of all the tools and modules that will be impacted by this change.</p>
</div>
<div class="section" id="rejected-ideas">
<h1><a class="toc-backref" href="#id19">Rejected Ideas</a></h1>
<div class="section" id="do-nothing">
<h2><a class="toc-backref" href="#id20">Do Nothing</a></h2>
<p>Always an option, just not adding it. It was considered
though that the benefits of adding it is worth the complexity
it adds to the language.</p>
</div>
<div class="section" id="after-marker-proposal">
<h2><a class="toc-backref" href="#id21">After marker proposal</a></h2>
<p>A complaint against the proposal is the fact that the modifier of
the signature impacts the &quot;already passed&quot; tokens.</p>
<p>This might make confusing to &quot;human parsers&quot; to read functions
with many arguments. Example:</p>
<pre class="literal-block">
def really_bad_example_of_a_python_function(fist_long_argument, second_long_argument,
                                            third_long_argument, /):
</pre>
<p>It is not until you reach the end of the signature that the reader
realized the <tt class="docutils literal">/</tt> and therefore the fact that the arguments are
position-only. This deviates from how the keyword-only marker works.</p>
<p>That said we could not find an implementation that would modify the
arguments after the marker, as that will force the one before the
marker to be position only as well. Example:</p>
<pre class="literal-block">
def (x, y, /, z):
</pre>
<p>If we define that <tt class="docutils literal">/</tt> makes only z position-only it won't be possible
to call x and y via keyword argument. Finding a way to work around it
will add confusion given that at the moment keyword arguments cannot be
followed by positional arguments. <tt class="docutils literal">/</tt> will therefore make both the
preceding and following position-only.</p>
</div>
<div class="section" id="per-argument-marker">
<h2><a class="toc-backref" href="#id22">Per-argument marker</a></h2>
<p>Using a per argument marker might be an option as well. The approach
basically adds a token to each of the arguments that are position only
and requires those to be placed together. Example:</p>
<pre class="literal-block">
def (.arg1, .arg2, arg3):
</pre>
<p>Note the dot on arg1 and arg2. Even if this approach might look easier
to read it has been discarded as <tt class="docutils literal">/</tt> goes further inline with the
keyword-only approach and is less error prone.</p>
</div>
<div class="section" id="using-decorators">
<h2><a class="toc-backref" href="#id23">Using decorators</a></h2>
<p>It has been suggested on python-ideas <a class="footnote-reference" href="#python-ideas-decorator-based" id="id8">[8]</a> to provide
a decorator written in Python as an implementation for this feature. This approach
has the advantage that keeps parameter declaration more easy to read but also
introduces an asymmetry on how parameter behaviour is declared. Also, as the <tt class="docutils literal">/</tt>
syntax is already introduced for C functions, this inconsistency will make more
difficult to implement all tools and modules that deal with this syntax including
but not limited to, the argument clinic, the inspect module and the ast module.
Another disadvantage of this approach is that calling the decorated functions
will be slower than the functions generated if the feature was implemented directly
in C.</p>
</div>
</div>
<div class="section" id="thanks">
<h1><a class="toc-backref" href="#id24">Thanks</a></h1>
<p>Credit for most of the content of this PEP is contained in Larry Hastings’s <a class="reference external" href="/dev/peps/pep-0457">PEP 457</a>.</p>
<p>Credit for the use of '/' as the separator between positional-only and positional-or-keyword
parameters go to Guido van Rossum, in a proposal from 2012. <a class="footnote-reference" href="#guido" id="id9">[6]</a></p>
<p>Credit for discussion about the simplification of the grammar goes to
Braulio Valdivieso.</p>
<table class="docutils footnote" frame="void" id="dict" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td><a class="reference external" href="http://docs.python.org/3/library/stdtypes.html#dict">http://docs.python.org/3/library/stdtypes.html#dict</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="range" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> <a class="reference external" href="http://docs.python.org/3/library/functions.html#func-range">http://docs.python.org/3/library/functions.html#func-range</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="border" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><a class="reference external" href="http://docs.python.org/3/library/curses.html#curses.window.border">http://docs.python.org/3/library/curses.html#curses.window.border</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="sendfile" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td><a class="reference external" href="http://docs.python.org/3/library/os.html#os.sendfile">http://docs.python.org/3/library/os.html#os.sendfile</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="addch" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[5]</a></td><td><a class="reference external" href="http://docs.python.org/3/library/curses.html#curses.window.addch">http://docs.python.org/3/library/curses.html#curses.window.addch</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="guido" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[6]</a></td><td>Guido van Rossum, posting to python-ideas, March 2012:
<a class="reference external" href="https://mail.python.org/pipermail/python-ideas/2012-March/014364.html">https://mail.python.org/pipermail/python-ideas/2012-March/014364.html</a>
and
<a class="reference external" href="https://mail.python.org/pipermail/python-ideas/2012-March/014378.html">https://mail.python.org/pipermail/python-ideas/2012-March/014378.html</a>
and
<a class="reference external" href="https://mail.python.org/pipermail/python-ideas/2012-March/014417.html">https://mail.python.org/pipermail/python-ideas/2012-March/014417.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="pep306" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[7]</a></td><td><a class="reference external" href="https://www.python.org/dev/peps/pep-0306/">https://www.python.org/dev/peps/pep-0306/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="python-ideas-decorator-based" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[8]</a></td><td><a class="reference external" href="https://mail.python.org/pipermail/python-ideas/2017-February/044888.html">https://mail.python.org/pipermail/python-ideas/2017-February/044888.html</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id25">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
</div>


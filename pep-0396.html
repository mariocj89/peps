<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">396</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Module Version Numbers</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">65628</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0396.txt">2008-08-10 09:59:20 -0400 (Sun, 10 Aug 2008)</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Barry Warsaw &lt;barry&#32;&#97;t&#32;python.org&gt;</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Deferred</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Informational</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">2011-03-16</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">2011-04-05</td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id21">Abstract</a></li>
<li><a class="reference internal" href="#pep-deferral" id="id22">PEP Deferral</a></li>
<li><a class="reference internal" href="#user-stories" id="id23">User Stories</a></li>
<li><a class="reference internal" href="#rationale" id="id24">Rationale</a></li>
<li><a class="reference internal" href="#specification" id="id25">Specification</a></li>
<li><a class="reference internal" href="#examples" id="id26">Examples</a></li>
<li><a class="reference internal" href="#deriving" id="id27">Deriving</a><ul>
<li><a class="reference internal" href="#classic-distutils" id="id28">Classic distutils</a></li>
<li><a class="reference internal" href="#distutils2" id="id29">Distutils2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pep-376-metadata" id="id30">PEP 376 metadata</a></li>
<li><a class="reference internal" href="#references" id="id31">References</a></li>
<li><a class="reference internal" href="#copyright" id="id32">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id21">Abstract</a></h1>
<p>Given that it is useful and common to specify version numbers for
Python modules, and given that different ways of doing this have grown
organically within the Python community, it is useful to establish
standard conventions for module authors to adhere to and reference.
This informational PEP describes best practices for Python module
authors who want to define the version number of their Python module.</p>
<p>Conformance with this PEP is optional, however other Python tools
(such as <tt class="docutils literal">distutils2</tt> <a class="footnote-reference" href="#id11" id="id1">[1]</a>) may be adapted to use the conventions
defined here.</p>
</div>
<div class="section" id="pep-deferral">
<h1><a class="toc-backref" href="#id22">PEP Deferral</a></h1>
<p>Further exploration of the concepts covered in this PEP has been deferred
for lack of a current champion interested in promoting the goals of the PEP
and collecting and incorporating feedback, and with sufficient available
time to do so effectively.</p>
</div>
<div class="section" id="user-stories">
<h1><a class="toc-backref" href="#id23">User Stories</a></h1>
<p>Alice is writing a new module, called <tt class="docutils literal">alice</tt>, which she wants to
share with other Python developers.  <tt class="docutils literal">alice</tt> is a simple module and
lives in one file, <tt class="docutils literal">alice.py</tt>.  Alice wants to specify a version
number so that her users can tell which version they are using.
Because her module lives entirely in one file, she wants to add the
version number to that file.</p>
<p>Bob has written a module called <tt class="docutils literal">bob</tt> which he has shared with many
users.  <tt class="docutils literal">bob.py</tt> contains a version number for the convenience of
his users.  Bob learns about the Cheeseshop <a class="footnote-reference" href="#id12" id="id2">[2]</a>, and adds some simple
packaging using classic distutils so that he can upload <em>The Bob
Bundle</em> to the Cheeseshop.  Because <tt class="docutils literal">bob.py</tt> already specifies a
version number which his users can access programmatically, he wants
the same API to continue to work even though his users now get it from
the Cheeseshop.</p>
<p>Carol maintains several namespace packages, each of which are
independently developed and distributed.  In order for her users to
properly specify dependencies on the right versions of her packages,
she specifies the version numbers in the namespace package's
<tt class="docutils literal">setup.py</tt> file.  Because Carol wants to have to update one version
number per package, she specifies the version number in her module and
has the <tt class="docutils literal">setup.py</tt> extract the module version number when she builds
the <em>sdist</em> archive.</p>
<p>David maintains a package in the standard library, and also produces
standalone versions for other versions of Python.  The standard
library copy defines the version number in the module, and this same
version number is used for the standalone distributions as well.</p>
</div>
<div class="section" id="rationale">
<h1><a class="toc-backref" href="#id24">Rationale</a></h1>
<p>Python modules, both in the standard library and available from third
parties, have long included version numbers.  There are established
de facto standards for describing version numbers, and many ad-hoc
ways have grown organically over the years.  Often, version numbers
can be retrieved from a module programmatically, by importing the
module and inspecting an attribute.  Classic Python distutils
<tt class="docutils literal">setup()</tt> functions <a class="footnote-reference" href="#id13" id="id3">[3]</a> describe a <tt class="docutils literal">version</tt> argument where the
release's version number can be specified.  <a class="reference external" href="/dev/peps/pep-0008">PEP 8</a> <a class="footnote-reference" href="#id14" id="id4">[4]</a> describes the
use of a module attribute called <tt class="docutils literal">__version__</tt> for recording
&quot;Subversion, CVS, or RCS&quot; version strings using keyword expansion.  In
the PEP author's own email archives, the earliest example of the use
of an <tt class="docutils literal">__version__</tt> module attribute by independent module
developers dates back to 1995.</p>
<p>Another example of version information is the sqlite3 <a class="footnote-reference" href="#id15" id="id5">[5]</a> module
with its <tt class="docutils literal">sqlite_version_info</tt>, <tt class="docutils literal">version</tt>, and <tt class="docutils literal">version_info</tt>
attributes.  It may not be immediately obvious which attribute
contains a version number for the module, and which contains a version
number for the underlying SQLite3 library.</p>
<p>This informational PEP codifies established practice, and recommends
standard ways of describing module version numbers, along with some
use cases for when -- and when <em>not</em> -- to include them.  Its adoption
by module authors is purely voluntary; packaging tools in the standard
library will provide optional support for the standards defined
herein, and other tools in the Python universe may comply as well.</p>
</div>
<div class="section" id="specification">
<h1><a class="toc-backref" href="#id25">Specification</a></h1>
<ol class="arabic simple">
<li>In general, modules in the standard library SHOULD NOT have version
numbers.  They implicitly carry the version number of the Python
release they are included in.</li>
<li>On a case-by-case basis, standard library modules which are also
released in standalone form for other Python versions MAY include a
module version number when included in the standard library, and
SHOULD include a version number when packaged separately.</li>
<li>When a module (or package) includes a version number, the version
SHOULD be available in the <tt class="docutils literal">__version__</tt> attribute.</li>
<li>For modules which live inside a namespace package, the module
SHOULD include the <tt class="docutils literal">__version__</tt> attribute.  The namespace
package itself SHOULD NOT include its own <tt class="docutils literal">__version__</tt>
attribute.</li>
<li>The <tt class="docutils literal">__version__</tt> attribute's value SHOULD be a string.</li>
<li>Module version numbers SHOULD conform to the normalized version
format specified in <a class="reference external" href="/dev/peps/pep-0386">PEP 386</a> <a class="footnote-reference" href="#id16" id="id6">[6]</a>.</li>
<li>Module version numbers SHOULD NOT contain version control system
supplied revision numbers, or any other semantically different
version numbers (e.g. underlying library version number).</li>
<li>The <tt class="docutils literal">version</tt> attribute in a classic distutils <tt class="docutils literal">setup.py</tt>
file, or the <a class="reference external" href="/dev/peps/pep-0345">PEP 345</a> <a class="footnote-reference" href="#id17" id="id7">[7]</a> <tt class="docutils literal">Version</tt> metadata field SHOULD be
derived from the <tt class="docutils literal">__version__</tt> field, or vice versa.</li>
</ol>
</div>
<div class="section" id="examples">
<h1><a class="toc-backref" href="#id26">Examples</a></h1>
<p>Retrieving the version number from a third party package:</p>
<pre class="literal-block">
&gt;&gt;&gt; import bzrlib
&gt;&gt;&gt; bzrlib.__version__
'2.3.0'
</pre>
<p>Retrieving the version number from a standard library package that is
also distributed as a standalone module:</p>
<pre class="literal-block">
&gt;&gt;&gt; import email
&gt;&gt;&gt; email.__version__
'5.1.0'
</pre>
<p>Version numbers for namespace packages:</p>
<pre class="literal-block">
&gt;&gt;&gt; import flufl.i18n
&gt;&gt;&gt; import flufl.enum
&gt;&gt;&gt; import flufl.lock

&gt;&gt;&gt; print flufl.i18n.__version__
1.0.4
&gt;&gt;&gt; print flufl.enum.__version__
3.1
&gt;&gt;&gt; print flufl.lock.__version__
2.1

&gt;&gt;&gt; import flufl
&gt;&gt;&gt; flufl.__version__
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: 'module' object has no attribute '__version__'
&gt;&gt;&gt;
</pre>
</div>
<div class="section" id="deriving">
<h1><a class="toc-backref" href="#id27">Deriving</a></h1>
<p>Module version numbers can appear in at least two places, and
sometimes more.  For example, in accordance with this PEP, they are
available programmatically on the module's <tt class="docutils literal">__version__</tt> attribute.
In a classic distutils <tt class="docutils literal">setup.py</tt> file, the <tt class="docutils literal">setup()</tt> function
takes a <tt class="docutils literal">version</tt> argument, while the distutils2 <tt class="docutils literal">setup.cfg</tt> file
has a <tt class="docutils literal">version</tt> key.  The version number must also get into the <a class="reference external" href="/dev/peps/pep-0345">PEP
345</a> metadata, preferably when the <em>sdist</em> archive is built.  It's
desirable for module authors to only have to specify the version
number once, and have all the other uses derive from this single
definition.</p>
<p>This could be done in any number of ways, a few of which are outlined
below.  These are included for illustrative purposes only and are not
intended to be definitive, complete, or all-encompassing.  Other
approaches are possible, and some included below may have limitations
that prevent their use in some situations.</p>
<p>Let's say Elle adds this attribute to her module file <tt class="docutils literal">elle.py</tt>:</p>
<pre class="literal-block">
__version__ = '3.1.1'
</pre>
<div class="section" id="classic-distutils">
<h2><a class="toc-backref" href="#id28">Classic distutils</a></h2>
<p>In classic distutils, the simplest way to add the version string to
the <tt class="docutils literal">setup()</tt> function in <tt class="docutils literal">setup.py</tt> is to do something like
this:</p>
<pre class="literal-block">
from elle import __version__
setup(name='elle', version=__version__)
</pre>
<p>In the PEP author's experience however, this can fail in some cases,
such as when the module uses automatic Python 3 conversion via the
<tt class="docutils literal">2to3</tt> program (because <tt class="docutils literal">setup.py</tt> is executed by Python 3 before
the <tt class="docutils literal">elle</tt> module has been converted).</p>
<p>In that case, it's not much more difficult to write a little code to
parse the <tt class="docutils literal">__version__</tt> from the file rather than importing it.
Without providing too much detail, it's likely that modules such as
<tt class="docutils literal">distutils2</tt> will provide a way to parse version strings from files.
E.g.:</p>
<pre class="literal-block">
from distutils2 import get_version
setup(name='elle', version=get_version('elle.py'))
</pre>
</div>
<div class="section" id="distutils2">
<h2><a class="toc-backref" href="#id29">Distutils2</a></h2>
<p>Because the distutils2 style <tt class="docutils literal">setup.cfg</tt> is declarative, we can't
run any code to extract the <tt class="docutils literal">__version__</tt> attribute, either via
import or via parsing.</p>
<p>In consultation with the distutils-sig <a class="footnote-reference" href="#id19" id="id8">[9]</a>, two options are
proposed.  Both entail containing the version number in a file, and
declaring that file in the <tt class="docutils literal">setup.cfg</tt>.  When the entire contents of
the file contains the version number, the <tt class="docutils literal"><span class="pre">version-file</span></tt> key will be
used:</p>
<pre class="literal-block">
[metadata]
version-file: version.txt
</pre>
<p>When the version number is contained within a larger file, e.g. of
Python code, such that the file must be parsed to extract the version,
the key <tt class="docutils literal"><span class="pre">version-from-file</span></tt> will be used:</p>
<pre class="literal-block">
[metadata]
version-from-file: elle.py
</pre>
<p>A parsing method similar to that described above will be performed on
the file named after the colon.  The exact recipe for doing this will
be discussed in the appropriate distutils2 development forum.</p>
<p>An alternative is to only define the version number in <tt class="docutils literal">setup.cfg</tt>
and use the <tt class="docutils literal">pkgutil</tt> module <a class="footnote-reference" href="#id18" id="id9">[8]</a> to make it available
programmatically.  E.g. in <tt class="docutils literal">elle.py</tt>:</p>
<pre class="literal-block">
from distutils2._backport import pkgutil
__version__ = pkgutil.get_distribution('elle').metadata['version']
</pre>
</div>
</div>
<div class="section" id="pep-376-metadata">
<h1><a class="reference external" href="/dev/peps/pep-0376">PEP 376</a> metadata</h1>
<p><a class="reference external" href="/dev/peps/pep-0376">PEP 376</a> <a class="footnote-reference" href="#id20" id="id10">[10]</a> defines a standard for static metadata, but doesn't
describe the process by which this metadata gets created.  It is
highly desirable for the derived version information to be placed into
the <a class="reference external" href="/dev/peps/pep-0376">PEP 376</a> <tt class="docutils literal"><span class="pre">.dist-info</span></tt> metadata at build-time rather than
install-time.  This way, the metadata will be available for
introspection even when the code is not installed.</p>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id31">References</a></h1>
<table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Distutils2 documentation
(<a class="reference external" href="http://distutils2.notmyidea.org/">http://distutils2.notmyidea.org/</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>The Cheeseshop (Python Package Index)
(<a class="reference external" href="http://pypi.python.org">http://pypi.python.org</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><a class="reference external" href="http://docs.python.org/distutils/setupscript.html">http://docs.python.org/distutils/setupscript.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td><a class="reference external" href="/dev/peps/pep-0008">PEP 8</a>, Style Guide for Python Code
(<a class="reference external" href="http://www.python.org/dev/peps/pep-0008">http://www.python.org/dev/peps/pep-0008</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id15" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[5]</a></td><td>sqlite3 module documentation
(<a class="reference external" href="http://docs.python.org/library/sqlite3.html">http://docs.python.org/library/sqlite3.html</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id16" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[6]</a></td><td><a class="reference external" href="/dev/peps/pep-0386">PEP 386</a>, Changing the version comparison module in Distutils
(<a class="reference external" href="http://www.python.org/dev/peps/pep-0386/">http://www.python.org/dev/peps/pep-0386/</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id17" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[7]</a></td><td><a class="reference external" href="/dev/peps/pep-0345">PEP 345</a>, Metadata for Python Software Packages 1.2
(<a class="reference external" href="http://www.python.org/dev/peps/pep-0345/#version">http://www.python.org/dev/peps/pep-0345/#version</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id18" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[8]</a></td><td>pkgutil - Package utilities
(<a class="reference external" href="http://distutils2.notmyidea.org/library/pkgutil.html">http://distutils2.notmyidea.org/library/pkgutil.html</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id19" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[9]</a></td><td><a class="reference external" href="https://mail.python.org/pipermail/distutils-sig/2011-June/017862.html">https://mail.python.org/pipermail/distutils-sig/2011-June/017862.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id20" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[10]</a></td><td><a class="reference external" href="/dev/peps/pep-0376">PEP 376</a>, Database of Installed Python Distributions
(<a class="reference external" href="http://www.python.org/dev/peps/pep-0376/">http://www.python.org/dev/peps/pep-0376/</a>)</td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id32">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
coding: utf-8
End: -->
</div>


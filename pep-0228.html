<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">228</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Reworking Python's Numeric Model</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0228.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">moshez&#32;&#97;t&#32;zadka.site.co.il (Moshe Zadka), guido&#32;&#97;t&#32;python.org (Guido van Rossum)</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Withdrawn</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">4-Nov-2000</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#withdrawal" id="id2">Withdrawal</a></li>
<li><a class="reference internal" href="#abstract" id="id3">Abstract</a></li>
<li><a class="reference internal" href="#rationale" id="id4">Rationale</a></li>
<li><a class="reference internal" href="#other-numerical-models" id="id5">Other Numerical Models</a></li>
<li><a class="reference internal" href="#suggested-interface-for-python-s-numerical-model" id="id6">Suggested Interface For Python's Numerical Model</a></li>
<li><a class="reference internal" href="#coercion" id="id7">Coercion</a></li>
<li><a class="reference internal" href="#inexact-operations" id="id8">Inexact Operations</a></li>
<li><a class="reference internal" href="#numerical-python-issues" id="id9">Numerical Python Issues</a></li>
<li><a class="reference internal" href="#unresolved-issues" id="id10">Unresolved Issues</a></li>
<li><a class="reference internal" href="#copyright" id="id11">Copyright</a></li>
</ul>
</div>
<div class="section" id="withdrawal">
<h1><a class="toc-backref" href="#id2">Withdrawal</a></h1>
<p>This PEP has been withdrawn in favor of <a class="reference external" href="/dev/peps/pep-3141">PEP 3141</a>.</p>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id3">Abstract</a></h1>
<p>Today, Python's numerical model is similar to the C numeric model:
there are several unrelated numerical types, and when operations
between numerical types are requested, coercions happen.  While
the C rationale for the numerical model is that it is very similar
to what happens at the hardware level, that rationale does not
apply to Python.  So, while it is acceptable to C programmers that
<tt class="docutils literal">2/3 == 0</tt>, it is surprising to many Python programmers.</p>
<p>NOTE: in the light of recent discussions in the newsgroup, the
motivation in this PEP (and details) need to be extended.</p>
</div>
<div class="section" id="rationale">
<h1><a class="toc-backref" href="#id4">Rationale</a></h1>
<p>In usability studies, one of the least usable aspect of Python was
the fact that integer division returns the floor of the division.
This makes it hard to program correctly, requiring casts to
<tt class="docutils literal">float()</tt> in various parts through the code.  Python's numerical
model stems from C, while a model that might be easier to work with
can be based on the mathematical understanding of numbers.</p>
</div>
<div class="section" id="other-numerical-models">
<h1><a class="toc-backref" href="#id5">Other Numerical Models</a></h1>
<p>Perl's numerical model is that there is one type of numbers --
floating point numbers.  While it is consistent and superficially
non-surprising, it tends to have subtle gotchas.  One of these is
that printing numbers is very tricky, and requires correct
rounding.  In Perl, there is also a mode where all numbers are
integers.  This mode also has its share of problems, which arise
from the fact that there is not even an approximate way of
dividing numbers and getting meaningful answers.</p>
</div>
<div class="section" id="suggested-interface-for-python-s-numerical-model">
<h1><a class="toc-backref" href="#id6">Suggested Interface For Python's Numerical Model</a></h1>
<p>While coercion rules will remain for add-on types and classes, the
built in type system will have exactly one Python type -- a
number.  There are several things which can be considered &quot;number
methods&quot;:</p>
<ol class="arabic simple">
<li><tt class="docutils literal">isnatural()</tt></li>
<li><tt class="docutils literal">isintegral()</tt></li>
<li><tt class="docutils literal">isrational()</tt></li>
<li><tt class="docutils literal">isreal()</tt></li>
<li><tt class="docutils literal">iscomplex()</tt></li>
<li><tt class="docutils literal">isexact()</tt></li>
</ol>
<p>Obviously, a number which answers true to a question from 1 to 5, will
also answer true to any following question. If <tt class="docutils literal">isexact()</tt> is not true,
then any answer might be wrong.
(But not horribly wrong: it's close to the truth.)</p>
<p>Now, there is two thing the models promises for the field operations
(<tt class="docutils literal">+</tt>, <tt class="docutils literal">-</tt>, <tt class="docutils literal">/</tt>, <tt class="docutils literal">*</tt>):</p>
<ul class="simple">
<li>If both operands satisfy <tt class="docutils literal">isexact()</tt>, the result satisfies
<tt class="docutils literal">isexact()</tt>.</li>
<li>All field rules are true, except that for not-<tt class="docutils literal">isexact()</tt> numbers,
they might be only approximately true.</li>
</ul>
<p>One consequence of these two rules is that all exact calcutions
are done as (complex) rationals: since the field laws must hold,
then</p>
<pre class="literal-block">
(a/b)*b == a
</pre>
<p>must hold.</p>
<p>There is built-in function, <tt class="docutils literal">inexact()</tt> which takes a number
and returns an inexact number which is a good approximation.
Inexact numbers must be as least as accurate as if they were
using IEEE-754.</p>
<p>Several of the classical Python functions will return exact numbers
even when given inexact numbers: e.g, <tt class="docutils literal">int()</tt>.</p>
</div>
<div class="section" id="coercion">
<h1><a class="toc-backref" href="#id7">Coercion</a></h1>
<p>The number type does not define <tt class="docutils literal">nb_coerce</tt>
Any numeric operation slot, when receiving something other then <tt class="docutils literal">PyNumber</tt>,
refuses to implement it.</p>
</div>
<div class="section" id="inexact-operations">
<h1><a class="toc-backref" href="#id8">Inexact Operations</a></h1>
<p>The functions in the <tt class="docutils literal">math</tt> module will be allowed to return
inexact results for exact values.  However, they will never return
a non-real number.  The functions in the <tt class="docutils literal">cmath</tt> module are also
allowed to return an inexact result for an exact argument, and are
furthermore allowed to return a complex result for a real
argument.</p>
</div>
<div class="section" id="numerical-python-issues">
<h1><a class="toc-backref" href="#id9">Numerical Python Issues</a></h1>
<p>People who use Numerical Python do so for high-performance vector
operations.  Therefore, NumPy should keep its hardware based
numeric model.</p>
</div>
<div class="section" id="unresolved-issues">
<h1><a class="toc-backref" href="#id10">Unresolved Issues</a></h1>
<p>Which number literals will be exact, and which inexact?</p>
<p>How do we deal with IEEE 754 operations? (probably, isnan/isinf should
be methods)</p>
<p>On 64-bit machines, comparisons between ints and floats may be
broken when the comparison involves conversion to float.  Ditto
for comparisons between longs and floats.  This can be dealt with
by avoiding the conversion to float.  (Due to Andrew Koenig.)</p>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id11">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
End: -->
</div>


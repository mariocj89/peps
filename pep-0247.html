<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">247</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">API for Cryptographic Hash Functions</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0247.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">A.M. Kuchling &lt;amk&#32;&#97;t&#32;amk.ca&gt;</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Final</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Informational</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">23-Mar-2001</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">20-Sep-2001</td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id2">Abstract</a></li>
<li><a class="reference internal" href="#specification" id="id3">Specification</a></li>
<li><a class="reference internal" href="#rationale" id="id4">Rationale</a></li>
<li><a class="reference internal" href="#changes" id="id5">Changes</a></li>
<li><a class="reference internal" href="#acknowledgements" id="id6">Acknowledgements</a></li>
<li><a class="reference internal" href="#copyright" id="id7">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id2">Abstract</a></h1>
<p>There are several different modules available that implement cryptographic
hashing algorithms such as MD5 or SHA.  This document specifies a standard API
for such algorithms, to make it easier to switch between different
implementations.</p>
</div>
<div class="section" id="specification">
<h1><a class="toc-backref" href="#id3">Specification</a></h1>
<p>All hashing modules should present the same interface.  Additional methods or
variables can be added, but those described in this document should always be
present.</p>
<p>Hash function modules define one function:</p>
<div class="line-block">
<div class="line"><tt class="docutils literal"><span class="pre">new([string])</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (unkeyed hashes)</tt></div>
<div class="line"><tt class="docutils literal"><span class="pre">new([key]</span> , [string])&nbsp;&nbsp;&nbsp; (keyed hashes)</tt></div>
</div>
<blockquote>
<p>Create a new hashing object and return it.  The first form is for hashes
that are unkeyed, such as MD5 or SHA.  For keyed hashes such as HMAC, <em>key</em>
is a required parameter containing a string giving the key to use.  In both
cases, the optional <em>string</em> parameter, if supplied, will be immediately
hashed into the object's starting state, as if <tt class="docutils literal">obj.update(string)</tt>
was called.</p>
<p>After creating a hashing object, arbitrary strings can be fed into the
object using its <tt class="docutils literal">update()</tt> method, and the hash value can be obtained at
any time by calling the object's <tt class="docutils literal">digest()</tt> method.</p>
<p>Arbitrary additional keyword arguments can be added to this function, but if
they're not supplied, sensible default values should be used.  For example,
<tt class="docutils literal">rounds</tt> and <tt class="docutils literal">digest_size</tt> keywords could be added for a hash function
which supports a variable number of rounds and several different output
sizes, and they should default to values believed to be secure.</p>
</blockquote>
<p>Hash function modules define one variable:</p>
<div class="line-block">
<div class="line"><tt class="docutils literal">digest_size</tt></div>
</div>
<blockquote>
An integer value; the size of the digest produced by the hashing objects
created by this module, measured in bytes. You could also obtain this value
by creating a sample object and accessing its <tt class="docutils literal">digest_size</tt> attribute, but
it can be convenient to have this value available from the module. Hashes
with a variable output size will set this variable to <tt class="docutils literal">None</tt>.</blockquote>
<p>Hashing objects require a single attribute:</p>
<div class="line-block">
<div class="line"><tt class="docutils literal">digest_size</tt></div>
</div>
<blockquote>
This attribute is identical to the module-level <tt class="docutils literal">digest_size</tt> variable,
measuring the size of the digest produced by the hashing object, measured in
bytes.  If the hash has a variable output size, this output size must be
chosen when the hashing object is created, and this attribute must contain
the selected size.  Therefore, <tt class="docutils literal">None</tt> is <em>not</em> a legal value for this
attribute.</blockquote>
<p>Hashing objects require the following methods:</p>
<div class="line-block">
<div class="line"><tt class="docutils literal">copy()</tt></div>
</div>
<blockquote>
Return a separate copy of this hashing object.  An update to this copy won't
affect the original object.</blockquote>
<div class="line-block">
<div class="line"><tt class="docutils literal">digest()</tt></div>
</div>
<blockquote>
Return the hash value of this hashing object as a string containing 8-bit
data.  The object is not altered in any way by this function; you can
continue updating the object after calling this function.</blockquote>
<div class="line-block">
<div class="line"><tt class="docutils literal">hexdigest()</tt></div>
</div>
<blockquote>
Return the hash value of this hashing object as a string containing
hexadecimal digits.  Lowercase letters should be used for the digits <tt class="docutils literal">a</tt>
through <tt class="docutils literal">f</tt>.  Like the <tt class="docutils literal">.digest()</tt> method, this method mustn't alter the
object.</blockquote>
<div class="line-block">
<div class="line"><tt class="docutils literal">update(string)</tt></div>
</div>
<blockquote>
Hash <em>string</em> into the current state of the hashing object. <tt class="docutils literal">update()</tt> can
be called any number of times during a hashing object's lifetime.</blockquote>
<p>Hashing modules can define additional module-level functions or object methods
and still be compliant with this specification.</p>
<p>Here's an example, using a module named <tt class="docutils literal">MD5</tt>:</p>
<pre class="literal-block">
&gt;&gt;&gt; from Crypto.Hash import MD5
&gt;&gt;&gt; m = MD5.new()
&gt;&gt;&gt; m.digest_size
16
&gt;&gt;&gt; m.update('abc')
&gt;&gt;&gt; m.digest()
'\x90\x01P\x98&lt;\xd2O\xb0\xd6\x96?}(\xe1\x7fr'
&gt;&gt;&gt; m.hexdigest()
'900150983cd24fb0d6963f7d28e17f72'
&gt;&gt;&gt; MD5.new('abc').digest()
'\x90\x01P\x98&lt;\xd2O\xb0\xd6\x96?}(\xe1\x7fr'
</pre>
</div>
<div class="section" id="rationale">
<h1><a class="toc-backref" href="#id4">Rationale</a></h1>
<p>The digest size is measured in bytes, not bits, even though hash algorithm
sizes are usually quoted in bits; MD5 is a 128-bit algorithm and not a 16-byte
one, for example.  This is because, in the sample code I looked at, the length
in bytes is often needed (to seek ahead or behind in a file; to compute the
length of an output string) while the length in bits is rarely used. Therefore,
the burden will fall on the few people actually needing the size in bits, who
will have to multiply <tt class="docutils literal">digest_size</tt> by 8.</p>
<p>It's been suggested that the <tt class="docutils literal">update()</tt> method would be better named
<tt class="docutils literal">append()</tt>.  However, that method is really causing the current state of the
hashing object to be updated, and <tt class="docutils literal">update()</tt> is already used by the md5 and
sha modules included with Python, so it seems simplest to leave the name
<tt class="docutils literal">update()</tt> alone.</p>
<p>The order of the constructor's arguments for keyed hashes was a sticky issue.
It wasn't clear whether the <em>key</em> should come first or second.  It's a required
parameter, and the usual convention is to place required parameters first, but
that also means that the <em>string</em> parameter moves from the first position to
the second. It would be possible to get confused and pass a single argument to
a keyed hash, thinking that you're passing an initial string to an unkeyed
hash, but it doesn't seem worth making the interface for keyed hashes more
obscure to avoid this potential error.</p>
</div>
<div class="section" id="changes">
<h1><a class="toc-backref" href="#id5">Changes</a></h1>
<p>2001-09-17: Renamed <tt class="docutils literal">clear()</tt> to <tt class="docutils literal">reset()</tt>; added <tt class="docutils literal">digest_size</tt> attribute
to objects; added <tt class="docutils literal">.hexdigest()</tt> method.</p>
<p>2001-09-20: Removed <tt class="docutils literal">reset()</tt> method completely.</p>
<p>2001-09-28: Set <tt class="docutils literal">digest_size</tt> to <tt class="docutils literal">None</tt> for variable-size hashes.</p>
</div>
<div class="section" id="acknowledgements">
<h1><a class="toc-backref" href="#id6">Acknowledgements</a></h1>
<p>Thanks to Aahz, Andrew Archibald, Rich Salz, Itamar Shtull-Trauring, and the
readers of the python-crypto list for their comments on this PEP.</p>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id7">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
End: -->
</div>


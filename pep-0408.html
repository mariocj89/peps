<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">408</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Standard library __preview__ package</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0408.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Nick Coghlan &lt;ncoghlan&#32;&#97;t&#32;gmail.com&gt;,
Eli Bendersky &lt;eliben&#32;&#97;t&#32;gmail.com&gt;</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Rejected</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">2012-01-07</td>
</tr>
<tr class="field"><th class="field-name">Python-Version:</th><td class="field-body">3.3</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">2012-01-27</td>
</tr>
<tr class="field"><th class="field-name">Resolution:</th><td class="field-body"><a class="reference external" href="https://mail.python.org/pipermail/python-dev/2012-January/115962.html">https://mail.python.org/pipermail/python-dev/2012-January/115962.html</a></td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id10">Abstract</a></li>
<li><a class="reference internal" href="#pep-rejection" id="id11">PEP Rejection</a></li>
<li><a class="reference internal" href="#proposal-the-preview-package" id="id12">Proposal - the __preview__ package</a><ul>
<li><a class="reference internal" href="#which-modules-should-go-through-preview" id="id13">Which modules should go through <tt class="docutils literal">__preview__</tt></a></li>
<li><a class="reference internal" href="#criteria-for-graduation" id="id14">Criteria for &quot;graduation&quot;</a></li>
<li><a class="reference internal" href="#example" id="id15">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rationale" id="id16">Rationale</a><ul>
<li><a class="reference internal" href="#benefits-for-the-core-development-team" id="id17">Benefits for the core development team</a></li>
<li><a class="reference internal" href="#benefits-for-end-users" id="id18">Benefits for end users</a></li>
</ul>
</li>
<li><a class="reference internal" href="#candidates-for-inclusion-into-preview" id="id19">Candidates for inclusion into __preview__</a></li>
<li><a class="reference internal" href="#relationship-with-pep-407" id="id20">Relationship with PEP 407</a></li>
<li><a class="reference internal" href="#rejected-alternatives-and-variations" id="id21">Rejected alternatives and variations</a><ul>
<li><a class="reference internal" href="#using-future" id="id22">Using <tt class="docutils literal">__future__</tt></a></li>
<li><a class="reference internal" href="#versioning-the-package" id="id23">Versioning the package</a></li>
<li><a class="reference internal" href="#using-a-package-name-without-leading-and-trailing-underscores" id="id24">Using a package name without leading and trailing underscores</a></li>
<li><a class="reference internal" href="#preserving-pickle-compatibility" id="id25">Preserving pickle compatibility</a></li>
</ul>
</li>
<li><a class="reference internal" href="#credits" id="id26">Credits</a></li>
<li><a class="reference internal" href="#references" id="id27">References</a></li>
<li><a class="reference internal" href="#copyright" id="id28">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id10">Abstract</a></h1>
<p>The process of including a new module into the Python standard library is
hindered by the API lock-in and promise of backward compatibility implied by
a module being formally part of Python.  This PEP proposes a transitional
state for modules - inclusion in a special <tt class="docutils literal">__preview__</tt> package for the
duration of a minor release (roughly 18 months) prior to full acceptance into
the standard library.  On one hand, this state provides the module with the
benefits of being formally part of the Python distribution.  On the other hand,
the core development team explicitly states that no promises are made with
regards to the module's eventual full inclusion into the standard library,
or to the stability of its API, which may change for the next release.</p>
</div>
<div class="section" id="pep-rejection">
<h1><a class="toc-backref" href="#id11">PEP Rejection</a></h1>
<p>Based on his experience with a similar &quot;labs&quot; namespace in Google App Engine,
Guido has rejected this PEP <a class="footnote-reference" href="#id8" id="id1">[3]</a> in favour of the simpler alternative of
explicitly marking provisional modules as such in their documentation.</p>
<p>If a module is otherwise considered suitable for standard library inclusion,
but some concerns remain regarding maintainability or certain API details,
then the module can be accepted on a provisional basis. While it is considered
an unlikely outcome, such modules <em>may</em> be removed from the standard library
without a deprecation period if the lingering concerns prove well-founded.</p>
<p>As part of the same announcement, Guido explicitly accepted Matthew
Barnett's 'regex' module <a class="footnote-reference" href="#id9" id="id2">[4]</a> as a provisional addition to the standard
library for Python 3.3 (using the 'regex' name, rather than as a drop-in
replacement for the existing 're' module).</p>
</div>
<div class="section" id="proposal-the-preview-package">
<h1><a class="toc-backref" href="#id12">Proposal - the __preview__ package</a></h1>
<p>Whenever the Python core development team decides that a new module should be
included into the standard library, but isn't entirely sure about whether the
module's API is optimal, the module can be placed in a special package named
<tt class="docutils literal">__preview__</tt> for a single minor release.</p>
<p>In the next minor release, the module may either be &quot;graduated&quot; into the
standard library (and occupy its natural place within its namespace, leaving the
<tt class="docutils literal">__preview__</tt> package), or be rejected and removed entirely from the Python
source tree.  If the module ends up graduating into the standard library after
spending a minor release in <tt class="docutils literal">__preview__</tt>, its API may be changed according
to accumulated feedback.  The core development team explicitly makes no
guarantees about API stability and backward compatibility of modules in
<tt class="docutils literal">__preview__</tt>.</p>
<p>Entry into the <tt class="docutils literal">__preview__</tt> package marks the start of a transition of the
module into the standard library.  It means that the core development team
assumes responsibility of the module, similarly to any other module in the
standard library.</p>
<div class="section" id="which-modules-should-go-through-preview">
<h2><a class="toc-backref" href="#id13">Which modules should go through <tt class="docutils literal">__preview__</tt></a></h2>
<p>We expect most modules proposed for addition into the Python standard library
to go through a minor release in <tt class="docutils literal">__preview__</tt>. There may, however, be some
exceptions, such as modules that use a pre-defined API (for example <tt class="docutils literal">lzma</tt>,
which generally follows the API of the existing <tt class="docutils literal">bz2</tt> module), or modules
with an API that has wide acceptance in the Python development community.</p>
<p>In any case, modules that are proposed to be added to the standard library,
whether via <tt class="docutils literal">__preview__</tt> or directly, must fulfill the acceptance conditions
set by <a class="reference external" href="/dev/peps/pep-0002">PEP 2</a>.</p>
<p>It is important to stress that the aim of this proposal is not to make the
process of adding new modules to the standard library more difficult.  On the
contrary, it tries to provide a means to add <em>more</em> useful libraries.  Modules
which are obvious candidates for entry can be added as before.  Modules which
due to uncertainties about the API could be stalled for a long time now have
a means to still be distributed with Python, via an incubation period in the
<tt class="docutils literal">__preview__</tt> package.</p>
</div>
<div class="section" id="criteria-for-graduation">
<h2><a class="toc-backref" href="#id14">Criteria for &quot;graduation&quot;</a></h2>
<p>In principle, most modules in the <tt class="docutils literal">__preview__</tt> package should eventually
graduate to the stable standard library.  Some reasons for not graduating are:</p>
<ul class="simple">
<li>The module may prove to be unstable or fragile, without sufficient developer
support to maintain it.</li>
<li>A much better alternative module may be found during the preview release</li>
</ul>
<p>Essentially, the decision will be made by the core developers on a per-case
basis.  The point to emphasize here is that a module's appearance in the
<tt class="docutils literal">__preview__</tt> package in some release does not guarantee it will continue
being part of Python in the next release.</p>
</div>
<div class="section" id="example">
<h2><a class="toc-backref" href="#id15">Example</a></h2>
<p>Suppose the <tt class="docutils literal">example</tt> module is a candidate for inclusion in the standard
library, but some Python developers aren't convinced that it presents the best
API for the problem it intends to solve.  The module can then be added to the
<tt class="docutils literal">__preview__</tt> package in release <tt class="docutils literal">3.X</tt>, importable via:</p>
<pre class="literal-block">
from __preview__ import example
</pre>
<p>Assuming the module is then promoted to the standard library proper in
release <tt class="docutils literal">3.X+1</tt>, it will be moved to a permanent location in the library:</p>
<pre class="literal-block">
import example
</pre>
<p>And importing it from <tt class="docutils literal">__preview__</tt> will no longer work.</p>
</div>
</div>
<div class="section" id="rationale">
<h1><a class="toc-backref" href="#id16">Rationale</a></h1>
<div class="section" id="benefits-for-the-core-development-team">
<h2><a class="toc-backref" href="#id17">Benefits for the core development team</a></h2>
<p>Currently, the core developers are really reluctant to add new interfaces to
the standard library.  This is because as soon as they're published in a
release, API design mistakes get locked in due to backward compatibility
concerns.</p>
<p>By gating all major API additions through some kind of a preview mechanism
for a full release, we get one full release cycle of community feedback
before we lock in the APIs with our standard backward compatibility guarantee.</p>
<p>We can also start integrating preview modules with the rest of the standard
library early, so long as we make it clear to packagers that the preview
modules should not be considered optional.  The only difference between preview
APIs and the rest of the standard library is that preview APIs are explicitly
exempted from the usual backward compatibility guarantees.</p>
<p>Essentially, the <tt class="docutils literal">__preview__</tt> package is intended to lower the risk of
locking in minor API design mistakes for extended periods of time.  Currently,
this concern can block new additions, even when the core development team
consensus is that a particular addition is a good idea in principle.</p>
</div>
<div class="section" id="benefits-for-end-users">
<h2><a class="toc-backref" href="#id18">Benefits for end users</a></h2>
<p>For future end users, the broadest benefit lies in a better &quot;out-of-the-box&quot;
experience - rather than being told &quot;oh, the standard library tools for task X
are horrible, download this 3rd party library instead&quot;, those superior tools
are more likely to be just be an import away.</p>
<p>For environments where developers are required to conduct due diligence on
their upstream dependencies (severely harming the cost-effectiveness of, or
even ruling out entirely, much of the material on PyPI), the key benefit lies
in ensuring that anything in the <tt class="docutils literal">__preview__</tt> package is clearly under
python-dev's aegis from at least the following perspectives:</p>
<ul class="simple">
<li>Licensing:  Redistributed by the PSF under a Contributor Licensing Agreement.</li>
<li>Documentation: The documentation of the module is published and organized via
the standard Python documentation tools (i.e. ReST source, output generated
with Sphinx and published on <a class="reference external" href="http://docs.python.org">http://docs.python.org</a>).</li>
<li>Testing: The module test suites are run on the python.org buildbot fleet
and results published via <a class="reference external" href="http://www.python.org/dev/buildbot">http://www.python.org/dev/buildbot</a>.</li>
<li>Issue management: Bugs and feature requests are handled on
<a class="reference external" href="http://bugs.python.org">http://bugs.python.org</a></li>
<li>Source control: The master repository for the software is published
on <a class="reference external" href="http://hg.python.org">http://hg.python.org</a>.</li>
</ul>
</div>
</div>
<div class="section" id="candidates-for-inclusion-into-preview">
<h1><a class="toc-backref" href="#id19">Candidates for inclusion into __preview__</a></h1>
<p>For Python 3.3, there are a number of clear current candidates:</p>
<ul class="simple">
<li><tt class="docutils literal">regex</tt> (<a class="reference external" href="http://pypi.python.org/pypi/regex">http://pypi.python.org/pypi/regex</a>)</li>
<li><tt class="docutils literal">daemon</tt> (<a class="reference external" href="/dev/peps/pep-3143">PEP 3143</a>)</li>
<li><tt class="docutils literal">ipaddr</tt> (<a class="reference external" href="/dev/peps/pep-3144">PEP 3144</a>)</li>
</ul>
<p>Other possible future use cases include:</p>
<ul class="simple">
<li>Improved HTTP modules (e.g. <tt class="docutils literal">requests</tt>)</li>
<li>HTML 5 parsing support (e.g. <tt class="docutils literal">html5lib</tt>)</li>
<li>Improved URL/URI/IRI parsing</li>
<li>A standard image API (<a class="reference external" href="/dev/peps/pep-0368">PEP 368</a>)</li>
<li>Encapsulation of the import state (<a class="reference external" href="/dev/peps/pep-0368">PEP 368</a>)</li>
<li>Standard event loop API (<a class="reference external" href="/dev/peps/pep-3153">PEP 3153</a>)</li>
<li>A binary version of WSGI for Python 3 (e.g. <a class="reference external" href="/dev/peps/pep-0444">PEP 444</a>)</li>
<li>Generic function support (e.g. <tt class="docutils literal">simplegeneric</tt>)</li>
</ul>
</div>
<div class="section" id="relationship-with-pep-407">
<h1>Relationship with <a class="reference external" href="/dev/peps/pep-0407">PEP 407</a></h1>
<p><a class="reference external" href="/dev/peps/pep-0407">PEP 407</a> proposes a change to the core Python release cycle to permit interim
releases every 6 months (perhaps limited to standard library updates). If
such a change to the release cycle is made, the following policy for the
<tt class="docutils literal">__preview__</tt> namespace is suggested:</p>
<ul class="simple">
<li>For long term support releases, the <tt class="docutils literal">__preview__</tt> namespace would always
be empty.</li>
<li>New modules would be accepted into the <tt class="docutils literal">__preview__</tt> namespace only in
interim releases that immediately follow a long term support release.</li>
<li>All modules added will either be migrated to their final location in the
standard library or dropped entirely prior to the next long term support
release.</li>
</ul>
</div>
<div class="section" id="rejected-alternatives-and-variations">
<h1><a class="toc-backref" href="#id21">Rejected alternatives and variations</a></h1>
<div class="section" id="using-future">
<h2><a class="toc-backref" href="#id22">Using <tt class="docutils literal">__future__</tt></a></h2>
<p>Python already has a &quot;forward-looking&quot; namespace in the form of the
<tt class="docutils literal">__future__</tt> module, so it's reasonable to ask why that can't be re-used for
this new purpose.</p>
<p>There are two reasons why doing so not appropriate:</p>
<p>1. The <tt class="docutils literal">__future__</tt> module is actually linked to a separate compiler
directives feature that can actually change the way the Python interpreter
compiles a module.  We don't want that for the preview package - we just want
an ordinary Python package.</p>
<p>2. The <tt class="docutils literal">__future__</tt> module comes with an express promise that names will be
maintained in perpetuity, long after the associated features have become the
compiler's default behaviour.  Again, this is precisely the opposite of what is
intended for the preview package - it is almost certain that all names added to
the preview will be removed at some point, most likely due to their being moved
to a permanent home in the standard library, but also potentially due to their
being reverted to third party package status (if community feedback suggests the
proposed addition is irredeemably broken).</p>
</div>
<div class="section" id="versioning-the-package">
<h2><a class="toc-backref" href="#id23">Versioning the package</a></h2>
<p>One proposed alternative <a class="footnote-reference" href="#id6" id="id3">[1]</a> was to add explicit versioning to the
<tt class="docutils literal">__preview__</tt> package, i.e. <tt class="docutils literal">__preview34__</tt>.  We think that it's better to
simply define that a module being in <tt class="docutils literal">__preview__</tt> in Python 3.X will either
graduate to the normal standard library namespace in Python 3.X+1 or will
disappear from the Python source tree altogether.  Versioning the <tt class="docutils literal">_preview__</tt>
package complicates the process and does not align well with the main intent of
this proposal.</p>
</div>
<div class="section" id="using-a-package-name-without-leading-and-trailing-underscores">
<h2><a class="toc-backref" href="#id24">Using a package name without leading and trailing underscores</a></h2>
<p>It was proposed <a class="footnote-reference" href="#id6" id="id4">[1]</a> to use a package name like <tt class="docutils literal">preview</tt> or <tt class="docutils literal">exp</tt>, instead
of <tt class="docutils literal">__preview__</tt>.  This was rejected in the discussion due to the special
meaning a &quot;dunder&quot; package name (that is, a name <em>with</em> leading and
trailing double-underscores) conveys in Python.  Besides, a non-dunder name
would suggest normal standard library API stability guarantees, which is not
the intention of the <tt class="docutils literal">__preview__</tt> package.</p>
</div>
<div class="section" id="preserving-pickle-compatibility">
<h2><a class="toc-backref" href="#id25">Preserving pickle compatibility</a></h2>
<p>A pickled class instance based on a module in <tt class="docutils literal">__preview__</tt> in release 3.X
won't be unpickle-able in release 3.X+1, where the module won't be in
<tt class="docutils literal">__preview__</tt>.  Special code may be added to make this work, but this goes
against the intent of this proposal, since it implies backward compatibility.
Therefore, this PEP does not propose to preserve pickle compatibility.</p>
</div>
</div>
<div class="section" id="credits">
<h1><a class="toc-backref" href="#id26">Credits</a></h1>
<p>Dj Gilcrease initially proposed the idea of having a <tt class="docutils literal">__preview__</tt> package
in Python <a class="footnote-reference" href="#id7" id="id5">[2]</a>.  Although his original proposal uses the name
<tt class="docutils literal">__experimental__</tt>, we feel that <tt class="docutils literal">__preview__</tt> conveys the meaning of this
package in a better way.</p>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id27">References</a></h1>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> Discussed in this thread:
<a class="reference external" href="https://mail.python.org/pipermail/python-ideas/2012-January/013246.html">https://mail.python.org/pipermail/python-ideas/2012-January/013246.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[2]</a></td><td><a class="reference external" href="https://mail.python.org/pipermail/python-ideas/2011-August/011278.html">https://mail.python.org/pipermail/python-ideas/2011-August/011278.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[3]</a></td><td>Guido's decision:
<a class="reference external" href="https://mail.python.org/pipermail/python-dev/2012-January/115962.html">https://mail.python.org/pipermail/python-dev/2012-January/115962.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[4]</a></td><td>Proposal for inclusion of regex: <a class="reference external" href="http://bugs.python.org/issue2636">http://bugs.python.org/issue2636</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id28">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
coding: utf-8
End: -->
</div>


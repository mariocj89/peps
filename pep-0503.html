<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">503</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Simple Repository API</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0503.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Donald Stufft &lt;donald&#32;&#97;t&#32;stufft.io&gt;</td>
</tr>
<tr class="field"><th class="field-name">BDFL-Delegate:</th><td class="field-body">Donald Stufft &lt;donald&#32;&#97;t&#32;stufft.io&gt;</td>
</tr>
<tr class="field"><th class="field-name">Discussions-To:</th><td class="field-body"><a class="reference external" href="mailto:distutils-sig&#64;python.org?subject=PEP%20503">distutils-sig&#32;&#97;t&#32;python.org</a></td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Accepted</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Informational</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">04-Sep-2015</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">04-Sep-2015</td>
</tr>
<tr class="field"><th class="field-name">Resolution:</th><td class="field-body"><a class="reference external" href="https://mail.python.org/pipermail/distutils-sig/2015-September/026899.html">https://mail.python.org/pipermail/distutils-sig/2015-September/026899.html</a></td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id2">Abstract</a></li>
<li><a class="reference internal" href="#specification" id="id3">Specification</a><ul>
<li><a class="reference internal" href="#normalized-names" id="id4">Normalized Names</a></li>
<li><a class="reference internal" href="#changes" id="id5">Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#copyright" id="id6">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id2">Abstract</a></h1>
<p>There are many implementations of a Python package repository and many tools
that consume them. Of these, the canonical implementation that defines what
the &quot;simple&quot; repository API looks like is the implementation that powers
PyPI. This document will specify that API, documenting what the correct
behavior for any implementation of the simple repository API.</p>
</div>
<div class="section" id="specification">
<h1><a class="toc-backref" href="#id3">Specification</a></h1>
<p>A repository that implements the simple API is defined by its base url, this is
the top level URL that all additional URLS are below. The API is named the
&quot;simple&quot; repository due to fact that PyPI's base URL is
<tt class="docutils literal"><span class="pre">https://pypi.python.org/simple/</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All subsequent URLs in this document will be relative to this base
URL (so given PyPI's URL, an URL of <tt class="docutils literal">/foo/</tt> would be
<tt class="docutils literal"><span class="pre">https://pypi.python.org/simple/foo/</span></tt>.</p>
</div>
<p>Within a repository, the root URL (<tt class="docutils literal">/</tt>) <strong>MUST</strong> be a valid HTML5 page with a
single anchor element per project in the repository. The text of the anchor tag
<strong>MUST</strong> be the normalized name of the project and the href attribute <strong>MUST</strong>
link to the URL for that particular project. As an example:</p>
<pre class="literal-block">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;body&gt;
    &lt;a href=&quot;/frob/&quot;&gt;frob&lt;/a&gt;
    &lt;a href=&quot;/spamspamspam/&quot;&gt;spamspamspam&lt;/a&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<p>Below the root URL is another URL for each individual project contained within
a repository. The format of this URL is <tt class="docutils literal">/&lt;project&gt;/</tt> where the <tt class="docutils literal">&lt;project&gt;</tt>
is replaced by the normalized name for that project, so a project named
&quot;HolyGrail&quot; would have an URL like <tt class="docutils literal">/holygrail/</tt>. This URL must respond with
a valid HTML5 page with a single anchor element per file for the project. The
text of the anchor tag <strong>MUST</strong> be the filename of the file and the href
attribute <strong>MUST</strong> be an URL that links to the location of the file for
download. The URL <strong>SHOULD</strong> include a hash in the form of an URL fragment with
the following syntax: <tt class="docutils literal"><span class="pre">#&lt;hashname&gt;=&lt;hashvalue&gt;</span></tt>, where <tt class="docutils literal">&lt;hashname&gt;</tt> is the
lowercase name of the hash function (such as <tt class="docutils literal">sha256</tt>) and <tt class="docutils literal">&lt;hashvalue&gt;</tt> is
the hex encoded digest.</p>
<p>In addition to the above, the following constraints are placed on the API:</p>
<ul>
<li><p class="first">All URLs which respond with an HTML5 page <strong>MUST</strong> end with a <tt class="docutils literal">/</tt> and the
repository <strong>SHOULD</strong> redirect the URLs without a <tt class="docutils literal">/</tt> to add a <tt class="docutils literal">/</tt> to the
end.</p>
</li>
<li><p class="first">URLs may be either absolute or relative as long as they point to the correct
location.</p>
</li>
<li><p class="first">There is no constraints on where the files must be hosted relative to the
repository.</p>
</li>
<li><p class="first">There may be any other HTML elements on the API pages as long as the required
anchor elements exist.</p>
</li>
<li><p class="first">Repositories <strong>MAY</strong> redirect unnormalized URLs to the canonical normalized
URL (e.g. <tt class="docutils literal">/Foobar/</tt> may redirect to <tt class="docutils literal">/foobar/</tt>), however clients
<strong>MUST NOT</strong> rely on this redirection and <strong>MUST</strong> request the normalized
URL.</p>
</li>
<li><p class="first">Repositories <strong>SHOULD</strong> choose a hash function from one of the ones
guaranteed to be available via the <tt class="docutils literal">hashlib</tt> module in the Python standard
library (currently <tt class="docutils literal">md5</tt>, <tt class="docutils literal">sha1</tt>, <tt class="docutils literal">sha224</tt>, <tt class="docutils literal">sha256</tt>, <tt class="docutils literal">sha384</tt>,
<tt class="docutils literal">sha512</tt>). The current recommendation is to use <tt class="docutils literal">sha256</tt>.</p>
</li>
<li><p class="first">If there is a GPG signature for a particular distribution file it <strong>MUST</strong>
live alongside that file with the same name with a <tt class="docutils literal">.asc</tt> appended to it.
So if the file <tt class="docutils literal"><span class="pre">/packages/HolyGrail-1.0.tar.gz</span></tt> existed and had an
associated signature, the signature would be located at
<tt class="docutils literal"><span class="pre">/packages/HolyGrail-1.0.tar.gz.asc</span></tt>.</p>
</li>
<li><p class="first">A repository <strong>MAY</strong> include a <tt class="docutils literal"><span class="pre">data-gpg-sig</span></tt> attribute on a file link with
a value of either <tt class="docutils literal">true</tt> or <tt class="docutils literal">false</tt> to indicate whether or not there is a
GPG signature. Repositories that do this <strong>SHOULD</strong> include it on every link.</p>
</li>
<li><p class="first">A repository <strong>MAY</strong> include a <tt class="docutils literal"><span class="pre">data-requires-python</span></tt> attribute on a file
link. This exposes the <em>Requires-Python</em> metadata field, specified in <a class="reference external" href="/dev/peps/pep-0345">PEP 345</a>,
for the corresponding release. Where this is present, installer tools
<strong>SHOULD</strong> ignore the download when installing to a Python version that
doesn't satisfy the requirement. For example:</p>
<pre class="literal-block">
&lt;a href=&quot;...&quot; data-requires-python=&quot;&amp;gt;=3&quot;&gt;...&lt;/a&gt;
</pre>
<p>In the attribute value, &lt; and &gt; have to be HTML encoded as <tt class="docutils literal">&amp;lt;</tt> and
<tt class="docutils literal">&amp;gt;</tt>, respectively.</p>
</li>
</ul>
<div class="section" id="normalized-names">
<h2><a class="toc-backref" href="#id4">Normalized Names</a></h2>
<p>This PEP references the concept of a &quot;normalized&quot; project name. As per <a class="reference external" href="/dev/peps/pep-0426">PEP 426</a>
the only valid characters in a name are the ASCII alphabet, ASCII numbers,
<tt class="docutils literal">.</tt>, <tt class="docutils literal">-</tt>, and <tt class="docutils literal">_</tt>. The name should be lowercased with all runs of the
characters <tt class="docutils literal">.</tt>, <tt class="docutils literal">-</tt>, or <tt class="docutils literal">_</tt> replaced with a single <tt class="docutils literal">-</tt> character. This
can be implemented in Python with the <tt class="docutils literal">re</tt> module:</p>
<pre class="literal-block">
import re

def normalize(name):
    return re.sub(r&quot;[-_.]+&quot;, &quot;-&quot;, name).lower()
</pre>
</div>
<div class="section" id="changes">
<h2><a class="toc-backref" href="#id5">Changes</a></h2>
<ul class="simple">
<li>The optional <tt class="docutils literal"><span class="pre">data-requires-python</span></tt> attribute was added in July 2016.</li>
</ul>
</div>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id6">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
coding: utf-8
End: -->
</div>


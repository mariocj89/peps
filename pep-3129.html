<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">3129</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Class Decorators</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-3129.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Collin Winter &lt;collinwinter&#32;&#97;t&#32;google.com&gt;</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Final</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">1-May-2007</td>
</tr>
<tr class="field"><th class="field-name">Python-Version:</th><td class="field-body">3.0</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">7-May-2007</td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id9">Abstract</a></li>
<li><a class="reference internal" href="#rationale" id="id10">Rationale</a></li>
<li><a class="reference internal" href="#semantics" id="id11">Semantics</a></li>
<li><a class="reference internal" href="#implementation" id="id12">Implementation</a></li>
<li><a class="reference internal" href="#acceptance" id="id13">Acceptance</a></li>
<li><a class="reference internal" href="#references" id="id14">References</a></li>
<li><a class="reference internal" href="#copyright" id="id15">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id9">Abstract</a></h1>
<p>This PEP proposes class decorators, an extension to the function
and method decorators introduced in <a class="reference external" href="/dev/peps/pep-0318">PEP 318</a>.</p>
</div>
<div class="section" id="rationale">
<h1><a class="toc-backref" href="#id10">Rationale</a></h1>
<p>When function decorators were originally debated for inclusion in
Python 2.4, class decorators were seen as obscure and unnecessary
<a class="footnote-reference" href="#obscure" id="id1">[1]</a> thanks to metaclasses.  After several years' experience
with the Python 2.4.x series of releases and an increasing
familiarity with function decorators and their uses, the BDFL and
the community re-evaluated class decorators and recommended their
inclusion in Python 3.0 <a class="footnote-reference" href="#approval" id="id2">[2]</a>.</p>
<p>The motivating use-case was to make certain constructs more easily
expressed and less reliant on implementation details of the CPython
interpreter.  While it is possible to express class decorator-like
functionality using metaclasses, the results are generally
unpleasant and the implementation highly fragile <a class="footnote-reference" href="#motivation" id="id3">[3]</a>.  In
addition, metaclasses are inherited, whereas class decorators are not,
making metaclasses unsuitable for some, single class-specific uses of
class decorators. The fact that large-scale Python projects like Zope
were going through these wild contortions to achieve something like
class decorators won over the BDFL.</p>
</div>
<div class="section" id="semantics">
<h1><a class="toc-backref" href="#id11">Semantics</a></h1>
<p>The semantics and design goals of class decorators are the same as
for function decorators (<a class="footnote-reference" href="#id7" id="id4">[4]</a>, <a class="footnote-reference" href="#goals" id="id5">[5]</a>); the only
difference is that you're decorating a class instead of a function.
The following two snippets are semantically identical:</p>
<pre class="literal-block">
class A:
  pass
A = foo(bar(A))


&#64;foo
&#64;bar
class A:
  pass
</pre>
<p>For a detailed examination of decorators, please refer to <a class="reference external" href="/dev/peps/pep-0318">PEP 318</a>.</p>
</div>
<div class="section" id="implementation">
<h1><a class="toc-backref" href="#id12">Implementation</a></h1>
<p>Adapting Python's grammar to support class decorators requires
modifying two rules and adding a new rule:</p>
<pre class="literal-block">
funcdef: [decorators] 'def' NAME parameters ['-&gt;' test] ':' suite

compound_stmt: if_stmt | while_stmt | for_stmt | try_stmt |
               with_stmt | funcdef | classdef
</pre>
<p>need to be changed to</p>
<pre class="literal-block">
decorated: decorators (classdef | funcdef)

funcdef: 'def' NAME parameters ['-&gt;' test] ':' suite

compound_stmt: if_stmt | while_stmt | for_stmt | try_stmt |
               with_stmt | funcdef | classdef | decorated
</pre>
<p>Adding <tt class="docutils literal">decorated</tt> is necessary to avoid an ambiguity in the
grammar.</p>
<p>The Python AST and bytecode must be modified accordingly.</p>
<p>A reference implementation <a class="footnote-reference" href="#id8" id="id6">[6]</a> has been provided by
Jack Diederich.</p>
</div>
<div class="section" id="acceptance">
<h1><a class="toc-backref" href="#id13">Acceptance</a></h1>
<p>There was virtually no discussion following the posting of this PEP,
meaning that everyone agreed it should be accepted.</p>
<p>The patch was committed to Subversion as revision 55430.</p>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id14">References</a></h1>
<table class="docutils footnote" frame="void" id="obscure" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="http://www.python.org/dev/peps/pep-0318/#motivation">http://www.python.org/dev/peps/pep-0318/#motivation</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="approval" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="https://mail.python.org/pipermail/python-dev/2006-March/062942.html">https://mail.python.org/pipermail/python-dev/2006-March/062942.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="motivation" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><a class="reference external" href="https://mail.python.org/pipermail/python-dev/2006-March/062888.html">https://mail.python.org/pipermail/python-dev/2006-March/062888.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td><a class="reference external" href="http://www.python.org/dev/peps/pep-0318/#current-syntax">http://www.python.org/dev/peps/pep-0318/#current-syntax</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="goals" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[5]</a></td><td><a class="reference external" href="http://www.python.org/dev/peps/pep-0318/#design-goals">http://www.python.org/dev/peps/pep-0318/#design-goals</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[6]</a></td><td><a class="reference external" href="http://python.org/sf/1671208">http://python.org/sf/1671208</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id15">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
coding: utf-8
End: -->
</div>


<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">243</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Module Repository Upload Mechanism</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0243.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">jafo-pep&#32;&#97;t&#32;tummy.com (Sean Reifschneider)</td>
</tr>
<tr class="field"><th class="field-name">Discussions-To:</th><td class="field-body"><a class="reference external" href="mailto:distutils-sig&#64;python.org?subject=PEP%20243">distutils-sig&#32;&#97;t&#32;python.org</a></td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Withdrawn</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">18-Mar-2001</td>
</tr>
<tr class="field"><th class="field-name">Python-Version:</th><td class="field-body">2.1</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">20-Mar-2001, 24-Mar-2001</td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id9">Abstract</a></li>
<li><a class="reference internal" href="#upload-process" id="id10">Upload Process</a></li>
<li><a class="reference internal" href="#return-data" id="id11">Return Data</a></li>
<li><a class="reference internal" href="#sample-form" id="id12">Sample Form</a></li>
<li><a class="reference internal" href="#platforms" id="id13">Platforms</a></li>
<li><a class="reference internal" href="#status" id="id14">Status</a></li>
<li><a class="reference internal" href="#references" id="id15">References</a></li>
<li><a class="reference internal" href="#copyright" id="id16">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id9">Abstract</a></h1>
<p>For a module repository system (such as Perl's CPAN) to be
successful, it must be as easy as possible for module authors to
submit their work.  An obvious place for this submit to happen is
in the Distutils tools after the distribution archive has been
successfully created.  For example, after a module author has
tested their software (verifying the results of <tt class="docutils literal">setup.py sdist</tt>),
they might type <tt class="docutils literal">setup.py sdist <span class="pre">--submit</span></tt>.  This would flag
Distutils to submit the source distribution to the archive server
for inclusion and distribution to the mirrors.</p>
<p>This PEP only deals with the mechanism for submitting the software
distributions to the archive, and does not deal with the actual
archive/catalog server.</p>
</div>
<div class="section" id="upload-process">
<h1><a class="toc-backref" href="#id10">Upload Process</a></h1>
<p>The upload will include the Distutils <tt class="docutils literal"><span class="pre">PKG-INFO</span></tt> meta-data
information (as specified in <a class="reference external" href="/dev/peps/pep-0241">PEP 241</a> <a class="footnote-reference" href="#id6" id="id1">[1]</a>), the actual software
distribution, and other optional information.  This information
will be uploaded as a multi-part form encoded the same as a
regular HTML file upload request.  This form is posted using
<tt class="docutils literal"><span class="pre">ENCTYPE=&quot;multipart/form-data&quot;</span></tt> encoding <a class="footnote-reference" href="#id7" id="id2">[2]</a>.</p>
<p>The upload will be made to the host &quot;www.python.org&quot; on port
80/tcp (<tt class="docutils literal">POST <span class="pre">http://www.python.org:80/pypi</span></tt>).  The form
will consist of the following fields:</p>
<ul class="simple">
<li><tt class="docutils literal">distribution</tt> -- The file containing the module software (for
example, a <tt class="docutils literal">.tar.gz</tt> or <tt class="docutils literal">.zip</tt> file).</li>
<li><tt class="docutils literal">distmd5sum</tt> -- The MD5 hash of the uploaded distribution,
encoded in ASCII representing the hexadecimal representation
of the digest (<tt class="docutils literal">for byte in digest: s = s + <span class="pre">('%02x'</span> %
ord(byte))</tt>).</li>
<li><tt class="docutils literal">pkginfo</tt> (optional) -- The file containing the distribution
meta-data (as specified in <a class="reference external" href="/dev/peps/pep-0241">PEP 241</a> <a class="footnote-reference" href="#id6" id="id3">[1]</a>).  Note that if this is
not included, the distribution file is expected to be in <tt class="docutils literal">.tar</tt>
format (gzipped and bzipped compreesed are allowed) or <tt class="docutils literal">.zip</tt>
format, with a <tt class="docutils literal"><span class="pre">PKG-INFO</span></tt> file in the top-level directory it
extracts (<tt class="docutils literal"><span class="pre">package-1.00/PKG-INFO</span></tt>).</li>
<li><tt class="docutils literal">infomd5sum</tt> (required if pkginfo field is present) -- The MD5 hash
of the uploaded meta-data, encoded in ASCII representing the
hexadecimal representation of the digest (<tt class="docutils literal">for byte in digest:
s = s + <span class="pre">('%02x'</span> % ord(byte))</tt>).</li>
<li><tt class="docutils literal">platform</tt> (optional) -- A string representing the target
platform for this distribution.  This is only for binary
distributions.  It is encoded as
<tt class="docutils literal"><span class="pre">&lt;os_name&gt;-&lt;os_version&gt;-&lt;platform</span> <span class="pre">architecture&gt;-&lt;python</span>
version&gt;</tt>.</li>
<li><tt class="docutils literal">signature</tt> (optional) -- A OpenPGP-compatible signature <a class="footnote-reference" href="#id8" id="id4">[3]</a> of
the uploaded distribution as signed by the author.  This may
be used by the cataloging system to automate acceptance of
uploads.</li>
<li><tt class="docutils literal">protocol_version</tt> -- A string indicating the protocol version that
the client supports.  This document describes protocol version &quot;1&quot;.</li>
</ul>
</div>
<div class="section" id="return-data">
<h1><a class="toc-backref" href="#id11">Return Data</a></h1>
<p>The status of the upload will be reported using HTTP non-standard
(<tt class="docutils literal"><span class="pre">X-*</span></tt>) headers.  The <tt class="docutils literal"><span class="pre">X-Swalow-Status</span></tt> header may have the following
values:</p>
<ul class="simple">
<li><tt class="docutils literal">SUCCESS</tt> -- Indicates that the upload has succeeded.</li>
<li><tt class="docutils literal">FAILURE</tt> -- The upload is, for some reason, unable to be
processed.</li>
<li><tt class="docutils literal">TRYAGAIN</tt> -- The server is unable to accept the upload at this
time, but the client should try again at a later time.
Potential causes of this are resource shortages on the server,
administrative down-time, etc...</li>
</ul>
<p>Optionally, there may be a <tt class="docutils literal"><span class="pre">X-Swalow-Reason</span></tt> header which includes a
human-readable string which provides more detailed information about
the <tt class="docutils literal"><span class="pre">X-Swalow-Status</span></tt>.</p>
<p>If there is no <tt class="docutils literal"><span class="pre">X-Swalow-Status</span></tt> header, or it does not contain one of
the three strings above, it should be treated as a temporary failure.</p>
<p>Example:</p>
<pre class="literal-block">
&gt;&gt;&gt; f = urllib.urlopen('http://www.python.org:80/pypi')
&gt;&gt;&gt; s = f.headers['x-swalow-status']
&gt;&gt;&gt; s = s + ': ' + f.headers.get('x-swalow-reason', '&lt;None&gt;')
&gt;&gt;&gt; print s
FAILURE: Required field &quot;distribution&quot; missing.
</pre>
</div>
<div class="section" id="sample-form">
<h1><a class="toc-backref" href="#id12">Sample Form</a></h1>
<p>The upload client must submit the page in the same form as
Netscape Navigator version 4.76 for Linux produces when presented
with the following form:</p>
<pre class="literal-block">
&lt;H1&gt;Upload file&lt;/H1&gt;
&lt;FORM NAME=&quot;fileupload&quot; METHOD=&quot;POST&quot; ACTION=&quot;pypi&quot;
    ENCTYPE=&quot;multipart/form-data&quot;&gt;
&lt;INPUT TYPE=&quot;file&quot; NAME=&quot;distribution&quot;&gt;&lt;BR&gt;
&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;distmd5sum&quot;&gt;&lt;BR&gt;
&lt;INPUT TYPE=&quot;file&quot; NAME=&quot;pkginfo&quot;&gt;&lt;BR&gt;
&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;infomd5sum&quot;&gt;&lt;BR&gt;
&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;platform&quot;&gt;&lt;BR&gt;
&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;signature&quot;&gt;&lt;BR&gt;
&lt;INPUT TYPE=&quot;hidden&quot; NAME=&quot;protocol_version&quot; VALUE=&quot;1&quot;&gt;&lt;BR&gt;
&lt;INPUT TYPE=&quot;SUBMIT&quot; VALUE=&quot;Upload&quot;&gt;
&lt;/FORM&gt;
</pre>
</div>
<div class="section" id="platforms">
<h1><a class="toc-backref" href="#id13">Platforms</a></h1>
<p>The following are valid os names:</p>
<pre class="literal-block">
aix beos debian dos freebsd hpux mac macos mandrake netbsd
openbsd qnx redhat solaris suse windows yellowdog
</pre>
<p>The above include a number of different types of distributions of
Linux.  Because of versioning issues these must be split out, and
it is expected that when it makes sense for one system to use
distributions made on other similar systems, the download client
will make the distinction.</p>
<p>Version is the official version string specified by the vendor for
the particular release.  For example, &quot;2000&quot; and &quot;nt&quot; (Windows),
&quot;9.04&quot; (HP-UX), &quot;7.0&quot; (RedHat, Mandrake).</p>
<p>The following are valid architectures:</p>
<pre class="literal-block">
alpha hppa ix86 powerpc sparc ultrasparc
</pre>
</div>
<div class="section" id="status">
<h1><a class="toc-backref" href="#id14">Status</a></h1>
<p>I currently have a proof-of-concept client and server implemented.
I plan to have the Distutils patches ready for the 2.1 release.
Combined with Andrew's <a class="reference external" href="/dev/peps/pep-0241">PEP 241</a> <a class="footnote-reference" href="#id6" id="id5">[1]</a> for specifying distribution
meta-data, I hope to have a platform which will allow us to gather
real-world data for finalizing the catalog system for the 2.2
release.</p>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id15">References</a></h1>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id3">2</a>, <a class="fn-backref" href="#id5">3</a>)</em> Metadata for Python Software Package, Kuchling,
<a class="reference external" href="http://www.python.org/dev/peps/pep-0241/">http://www.python.org/dev/peps/pep-0241/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="http://tools.ietf.org/html/rfc1867.html">RFC 1867</a>, Form-based File Upload in HTML
<a class="reference external" href="http://www.faqs.org/rfcs/rfc1867.html">http://www.faqs.org/rfcs/rfc1867.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[3]</a></td><td><a class="reference external" href="http://tools.ietf.org/html/rfc2440.html">RFC 2440</a>, OpenPGP Message Format
<a class="reference external" href="http://www.faqs.org/rfcs/rfc2440.html">http://www.faqs.org/rfcs/rfc2440.html</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id16">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
End: -->
</div>


<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">394</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">The &quot;python&quot; Command on Unix-Like Systems</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0394.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Kerrick Staley &lt;mail&#32;&#97;t&#32;kerrickstaley.com&gt;,
Nick Coghlan &lt;ncoghlan&#32;&#97;t&#32;gmail.com&gt;,
Barry Warsaw &lt;barry&#32;&#97;t&#32;python.org&gt;</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Active</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Informational</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">02-Mar-2011</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">04-Mar-2011, 20-Jul-2011, 16-Feb-2012, 30-Sep-2014</td>
</tr>
<tr class="field"><th class="field-name">Resolution:</th><td class="field-body"><a class="reference external" href="https://mail.python.org/pipermail/python-dev/2012-February/116594.html">https://mail.python.org/pipermail/python-dev/2012-February/116594.html</a></td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id13">Abstract</a></li>
<li><a class="reference internal" href="#recommendation" id="id14">Recommendation</a></li>
<li><a class="reference internal" href="#rationale" id="id15">Rationale</a></li>
<li><a class="reference internal" href="#future-changes-to-this-recommendation" id="id16">Future Changes to this Recommendation</a></li>
<li><a class="reference internal" href="#migration-notes" id="id17">Migration Notes</a></li>
<li><a class="reference internal" href="#backwards-compatibility" id="id18">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#application-to-the-cpython-reference-interpreter" id="id19">Application to the CPython Reference Interpreter</a></li>
<li><a class="reference internal" href="#impact-on-python-environment-variables" id="id20">Impact on PYTHON* Environment Variables</a></li>
<li><a class="reference internal" href="#exclusion-of-ms-windows" id="id21">Exclusion of MS Windows</a></li>
<li><a class="reference internal" href="#references" id="id22">References</a></li>
<li><a class="reference internal" href="#copyright" id="id23">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id13">Abstract</a></h1>
<p>This PEP provides a convention to ensure that Python scripts can continue to
be portable across <tt class="docutils literal">*nix</tt> systems, regardless of the default version of the
Python interpreter (i.e. the version invoked by the <tt class="docutils literal">python</tt> command).</p>
<ul class="simple">
<li><tt class="docutils literal">python2</tt> will refer to some version of Python 2.x.</li>
<li><tt class="docutils literal">python3</tt> will refer to some version of Python 3.x.</li>
<li>for the time being, all distributions <em>should</em> ensure that <tt class="docutils literal">python</tt>
refers to the same target as <tt class="docutils literal">python2</tt>.</li>
<li>however, end users should be aware that <tt class="docutils literal">python</tt> refers to <tt class="docutils literal">python3</tt>
on at least Arch Linux (that change is what prompted the creation of this
PEP), so <tt class="docutils literal">python</tt> should be used in the shebang line only for scripts
that are source compatible with both Python 2 and 3.</li>
<li>in preparation for an eventual change in the default version of Python,
Python 2 only scripts should either be updated to be source compatible
with Python 3 or else to use <tt class="docutils literal">python2</tt> in the shebang line.</li>
</ul>
</div>
<div class="section" id="recommendation">
<h1><a class="toc-backref" href="#id14">Recommendation</a></h1>
<ul class="simple">
<li>Unix-like software distributions (including systems like Mac OS X and
Cygwin) should install the <tt class="docutils literal">python2</tt> command into the default path
whenever a version of the Python 2 interpreter is installed, and the same
for <tt class="docutils literal">python3</tt> and the Python 3 interpreter.</li>
<li>When  invoked, <tt class="docutils literal">python2</tt> should run some version of the Python 2
interpreter, and <tt class="docutils literal">python3</tt> should run some version of the Python 3
interpreter.</li>
<li>The more general <tt class="docutils literal">python</tt> command should be installed whenever
any version of Python 2 is installed and should invoke the same version of
Python as the <tt class="docutils literal">python2</tt> command (however, note that some distributions
have already chosen to have <tt class="docutils literal">python</tt> implement the <tt class="docutils literal">python3</tt>
command; see the <a class="reference internal" href="#rationale">Rationale</a> and <a class="reference internal" href="#migration-notes">Migration Notes</a> below).</li>
<li>The Python 2.x <tt class="docutils literal">idle</tt>, <tt class="docutils literal">pydoc</tt>, and <tt class="docutils literal"><span class="pre">python-config</span></tt> commands should
likewise be available as <tt class="docutils literal">idle2</tt>, <tt class="docutils literal">pydoc2</tt>, and <tt class="docutils literal"><span class="pre">python2-config</span></tt>,
with the original commands invoking these versions by default, but possibly
invoking the Python 3.x versions instead if configured to do so by the
system administrator.</li>
<li>In order to tolerate differences across platforms, all new code that needs
to invoke the Python interpreter should not specify <tt class="docutils literal">python</tt>, but rather
should specify either <tt class="docutils literal">python2</tt> or <tt class="docutils literal">python3</tt> (or the more specific
<tt class="docutils literal">python2.x</tt> and <tt class="docutils literal">python3.x</tt> versions; see the <a class="reference internal" href="#migration-notes">Migration Notes</a>).
This distinction should be made in shebangs, when invoking from a shell
script, when invoking via the system() call, or when invoking in any other
context.</li>
<li>One exception to this is scripts that are deliberately written to be source
compatible with both Python 2.x and 3.x. Such scripts may continue to use
<tt class="docutils literal">python</tt> on their shebang line without affecting their portability.</li>
<li>When reinvoking the interpreter from a Python script, querying
<tt class="docutils literal">sys.executable</tt> to avoid hardcoded assumptions regarding the
interpreter location remains the preferred approach.</li>
</ul>
<p>These recommendations are the outcome of the relevant python-dev discussions
in March and July 2011 (<a class="footnote-reference" href="#id7" id="id1">[1]</a>, <a class="footnote-reference" href="#id8" id="id2">[2]</a>), February 2012 (<a class="footnote-reference" href="#id10" id="id3">[4]</a>) and
September 2014 (<a class="footnote-reference" href="#id12" id="id4">[6]</a>).</p>
</div>
<div class="section" id="rationale">
<h1><a class="toc-backref" href="#id15">Rationale</a></h1>
<p>This recommendation is needed as, even though the majority of distributions
still alias the <tt class="docutils literal">python</tt> command to Python 2, some now alias it to
Python 3 (<a class="footnote-reference" href="#id11" id="id5">[5]</a>). As some of the former distributions did not provide a
<tt class="docutils literal">python2</tt> command by default, there was previously no way for Python 2 code
(or any code that invokes the Python 2 interpreter directly rather than via
<tt class="docutils literal">sys.executable</tt>) to reliably run on all Unix-like systems without
modification, as the <tt class="docutils literal">python</tt> command would invoke the wrong interpreter
version on some systems, and the <tt class="docutils literal">python2</tt> command would fail completely
on others. The recommendations in this PEP provide a very simple mechanism
to restore cross-platform support, with minimal additional work required
on the part of distribution maintainers.</p>
</div>
<div class="section" id="future-changes-to-this-recommendation">
<h1><a class="toc-backref" href="#id16">Future Changes to this Recommendation</a></h1>
<p>It is anticipated that there will eventually come a time where the third
party ecosystem surrounding Python 3 is sufficiently mature for this
recommendation to be updated to suggest that the <tt class="docutils literal">python</tt> symlink
refer to <tt class="docutils literal">python3</tt> rather than <tt class="docutils literal">python2</tt>.</p>
<p>This recommendation will be periodically reviewed over the next few years,
and updated when the core development team judges it appropriate. As a
point of reference, regular maintenance releases for the Python 2.7 series
will continue until at least 2020.</p>
</div>
<div class="section" id="migration-notes">
<h1><a class="toc-backref" href="#id17">Migration Notes</a></h1>
<p>This section does not contain any official recommendations from the core
CPython developers. It's merely a collection of notes regarding various
aspects of migrating to Python 3 as the default version of Python for a
system. They will hopefully be helpful to any distributions considering
making such a change.</p>
<ul>
<li><p class="first">The main barrier to a distribution switching the <tt class="docutils literal">python</tt> command from
<tt class="docutils literal">python2</tt> to <tt class="docutils literal">python3</tt> isn't breakage within the distribution, but
instead breakage of private third party scripts developed by sysadmins
and other users. Updating the <tt class="docutils literal">python</tt> command to invoke <tt class="docutils literal">python3</tt>
by default indicates that a distribution is willing to break such scripts
with errors that are potentially quite confusing for users that aren't
yet familiar with the backwards incompatible changes in Python 3. For
example, while the change of <tt class="docutils literal">print</tt> from a statement to a builtin
function is relatively simple for automated converters to handle, the
SyntaxError from attempting to use the Python 2 notation in versions of
Python 3 prior to 3.4.2 is thoroughly confusing if you aren't already
aware of the change:</p>
<pre class="literal-block">
$ python3 -c 'print &quot;Hello, world!&quot;'
  File &quot;&lt;string&gt;&quot;, line 1
    print &quot;Hello, world!&quot;
                        ^
SyntaxError: invalid syntax
</pre>
<p>(In Python 3.4.2+, that generic error message has been replaced with the
more explicit &quot;SyntaxError: Missing parentheses in call to 'print'&quot;)</p>
</li>
<li><p class="first">Avoiding breakage of such third party scripts is the key reason this
PEP recommends that <tt class="docutils literal">python</tt> continue to refer to <tt class="docutils literal">python2</tt> for the
time being. Until the conventions described in this PEP are more widely
adopted, having <tt class="docutils literal">python</tt> invoke <tt class="docutils literal">python2</tt> will remain the recommended
option.</p>
</li>
<li><p class="first">The <tt class="docutils literal">pythonX.X</tt> (e.g. <tt class="docutils literal">python2.6</tt>) commands exist on some systems, on
which they invoke specific minor versions of the Python interpreter. It
can be useful for distribution-specific packages to take advantage of these
utilities if they exist, since it will prevent code breakage if the default
minor version of a given major version is changed. However, scripts
intending to be cross-platform should not rely on the presence of these
utilities, but rather should be tested on several recent minor versions of
the target major version, compensating, if necessary, for the small
differences that exist between minor versions. This prevents the need for
sysadmins to install many very similar versions of the interpreter.</p>
</li>
<li><p class="first">When the <tt class="docutils literal">pythonX.X</tt> binaries are provided by a distribution, the
<tt class="docutils literal">python2</tt> and <tt class="docutils literal">python3</tt> commands should refer to one of those files
rather than being provided as a separate binary file.</p>
</li>
<li><p class="first">It is suggested that even distribution-specific packages follow the
<tt class="docutils literal">python2</tt>/<tt class="docutils literal">python3</tt> convention, even in code that is not intended to
operate on other distributions. This will reduce problems if the
distribution later decides to change the version of the Python interpreter
that the <tt class="docutils literal">python</tt> command invokes, or if a sysadmin installs a custom
<tt class="docutils literal">python</tt> command with a different major version than the distribution
default. Distributions can test whether they are fully following this
convention by changing the <tt class="docutils literal">python</tt> interpreter on a test box and checking
to see if anything breaks.</p>
</li>
<li><p class="first">If the above point is adhered to and sysadmins are permitted to change the
<tt class="docutils literal">python</tt> command, then the <tt class="docutils literal">python</tt> command should always be implemented
as a link to the interpreter binary (or a link to a link) and not vice
versa. That way, if a sysadmin does decide to replace the installed
<tt class="docutils literal">python</tt> file, they can do so without inadvertently deleting the
previously installed binary.</p>
</li>
<li><p class="first">If the Python 2 interpreter becomes uncommon, scripts should nevertheless
continue to use the <tt class="docutils literal">python3</tt> convention rather that just <tt class="docutils literal">python</tt>. This
will ease transition in the event that yet another major version of Python
is released.</p>
</li>
<li><p class="first">If these conventions are adhered to, it will become the case that the
<tt class="docutils literal">python</tt> command is only executed in an interactive manner as a user
convenience, or to run scripts that are source compatible with both Python
2 and Python 3.</p>
</li>
</ul>
</div>
<div class="section" id="backwards-compatibility">
<h1><a class="toc-backref" href="#id18">Backwards Compatibility</a></h1>
<p>A potential problem can arise if a script adhering to the
<tt class="docutils literal">python2</tt>/<tt class="docutils literal">python3</tt> convention is executed on a system not supporting
these commands. This is mostly a non-issue, since the sysadmin can simply
create these symbolic links and avoid further problems. It is a significantly
more obvious breakage than the sometimes cryptic errors that can arise when
attempting to execute a script containing Python 2 specific syntax with a
Python 3 interpreter.</p>
</div>
<div class="section" id="application-to-the-cpython-reference-interpreter">
<h1><a class="toc-backref" href="#id19">Application to the CPython Reference Interpreter</a></h1>
<p>While technically a new feature, the <tt class="docutils literal">make install</tt> and <tt class="docutils literal">make bininstall</tt>
command in the 2.7 version of CPython were adjusted to create the
following chains of symbolic links in the relevant <tt class="docutils literal">bin</tt> directory (the
final item listed in the chain is the actual installed binary, preceding
items are relative symbolic links):</p>
<pre class="literal-block">
python -&gt; python2 -&gt; python2.7
python-config -&gt; python2-config -&gt; python2.7-config
</pre>
<p>Similar adjustments were made to the Mac OS X binary installer.</p>
<p>This feature first appeared in the default installation process in
CPython 2.7.3.</p>
<p>The installation commands in the CPython 3.x series already create the
appropriate symlinks. For example, CPython 3.2 creates:</p>
<pre class="literal-block">
python3 -&gt; python3.2
idle3 -&gt; idle3.2
pydoc3 -&gt; pydoc3.2
python3-config -&gt; python3.2-config
</pre>
<p>And CPython 3.3 creates:</p>
<pre class="literal-block">
python3 -&gt; python3.3
idle3 -&gt; idle3.3
pydoc3 -&gt; pydoc3.3
python3-config -&gt; python3.3-config
pysetup3 -&gt; pysetup3.3
</pre>
<p>The implementation progress of these features in the default installers was
managed on the tracker as issue #12627 (<a class="footnote-reference" href="#id9" id="id6">[3]</a>).</p>
</div>
<div class="section" id="impact-on-python-environment-variables">
<h1><a class="toc-backref" href="#id20">Impact on PYTHON* Environment Variables</a></h1>
<p>The choice of target for the <tt class="docutils literal">python</tt> command implicitly affects a
distribution's expected interpretation of the various Python related
environment variables. The use of <tt class="docutils literal">*.pth</tt> files in the relevant
<tt class="docutils literal"><span class="pre">site-packages</span></tt> folder, the &quot;per-user site packages&quot; feature (see
<tt class="docutils literal">python <span class="pre">-m</span> site</tt>) or more flexible tools such as <tt class="docutils literal">virtualenv</tt> are all more
tolerant of the presence of multiple versions of Python on a system than the
direct use of <tt class="docutils literal">PYTHONPATH</tt>.</p>
</div>
<div class="section" id="exclusion-of-ms-windows">
<h1><a class="toc-backref" href="#id21">Exclusion of MS Windows</a></h1>
<p>This PEP deliberately excludes any proposals relating to Microsoft Windows, as
devising an equivalent solution for Windows was deemed too complex to handle
here. <a class="reference external" href="/dev/peps/pep-0397">PEP 397</a> and the related discussion on the python-dev mailing list
address this issue (like this PEP, the <a class="reference external" href="/dev/peps/pep-0397">PEP 397</a> launcher invokes Python 2 by
default if versions of both Python 2 and 3 are installed on the system).</p>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id22">References</a></h1>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Support the /usr/bin/python2 symlink upstream (with bonus grammar class!)
(<a class="reference external" href="https://mail.python.org/pipermail/python-dev/2011-March/108491.html">https://mail.python.org/pipermail/python-dev/2011-March/108491.html</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Rebooting PEP 394 (aka Support the /usr/bin/python2 symlink upstream)
(<a class="reference external" href="https://mail.python.org/pipermail/python-dev/2011-July/112322.html">https://mail.python.org/pipermail/python-dev/2011-July/112322.html</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[3]</a></td><td>Implement PEP 394 in the CPython Makefile
(<a class="reference external" href="http://bugs.python.org/issue12627">http://bugs.python.org/issue12627</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[4]</a></td><td>PEP 394 request for pronouncement (python2 symlink in *nix systems)
(<a class="reference external" href="https://mail.python.org/pipermail/python-dev/2012-February/116435.html">https://mail.python.org/pipermail/python-dev/2012-February/116435.html</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[5]</a></td><td>Arch Linux announcement that their &quot;python&quot; link now refers Python 3
(<a class="reference external" href="https://www.archlinux.org/news/python-is-now-python-3/">https://www.archlinux.org/news/python-is-now-python-3/</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[6]</a></td><td><a class="reference external" href="/dev/peps/pep-0394">PEP 394</a> - Clarification of what &quot;python&quot; command should invoke
(<a class="reference external" href="https://mail.python.org/pipermail/python-dev/2014-September/136374.html">https://mail.python.org/pipermail/python-dev/2014-September/136374.html</a>)</td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id23">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
</div>


<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">378</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Format Specifier for Thousands Separator</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0378.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Raymond Hettinger &lt;python&#32;&#97;t&#32;rcn.com&gt;</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Final</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">12-Mar-2009</td>
</tr>
<tr class="field"><th class="field-name">Python-Version:</th><td class="field-body">2.7 and 3.1</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">12-Mar-2009</td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#motivation" id="id20">Motivation</a></li>
<li><a class="reference internal" href="#main-proposal-from-nick-coghlan-originally-called-proposal-i" id="id21">Main Proposal (from Nick Coghlan, originally called Proposal I)</a></li>
<li><a class="reference internal" href="#current-version-of-the-mini-language" id="id22">Current Version of the Mini-Language</a></li>
<li><a class="reference internal" href="#research-into-what-other-languages-do" id="id23">Research into what Other Languages Do</a></li>
<li><a class="reference internal" href="#alternative-proposal-from-eric-smith-originally-called-proposal-ii" id="id24">Alternative Proposal (from Eric Smith, originally called Proposal II)</a></li>
<li><a class="reference internal" href="#commentary" id="id25">Commentary</a></li>
<li><a class="reference internal" href="#id1" id="id26">References</a></li>
<li><a class="reference internal" href="#copyright" id="id27">Copyright</a></li>
</ul>
</div>
<div class="section" id="motivation">
<h1><a class="toc-backref" href="#id20">Motivation</a></h1>
<p>Provide a simple, non-locale aware way to format a number
with a thousands separator.</p>
<p>Adding thousands separators is one of the simplest ways to
humanize a program's output, improving its professional appearance
and readability.</p>
<p>In the finance world, output with thousands separators is the norm.
Finance users and non-professional programmers find the locale
approach to be frustrating, arcane and non-obvious.</p>
<p>The locale module presents two other challenges.  First, it is
a global setting and not suitable for multi-threaded apps that
need to serve-up requests in multiple locales.  Second, the
name of a relevant locale (such as &quot;de_DE&quot;) can vary from
platform to platform or may not be defined at all.  The docs
for the locale module describe these and <a class="reference external" href="https://docs.python.org/2.6/library/locale.html#background-details-hints-tips-and-caveats">many other challenges</a> <a class="footnote-reference" href="#id2" id="id3">[1]</a>
in detail.</p>
<p>It is not the goal to replace the locale module, to perform
internationalization tasks, or accommodate every possible
convention.  Such tasks are better suited to robust tools like
<a class="reference external" href="http://babel.edgewall.org/">Babel</a> <a class="footnote-reference" href="#id4" id="id5">[2]</a>. Instead, the goal is to make a common, everyday
task easier for many users.</p>
</div>
<div class="section" id="main-proposal-from-nick-coghlan-originally-called-proposal-i">
<h1><a class="toc-backref" href="#id21">Main Proposal (from Nick Coghlan, originally called Proposal I)</a></h1>
<p>A comma will be added to the format() specifier mini-language:</p>
<pre class="literal-block">
[[fill]align][sign][#][0][width][,][.precision][type]
</pre>
<p>The ',' option indicates that commas should be included in the
output as a thousands separator. As with locales which do not
use a period as the decimal point, locales which use a
different convention for digit separation will need to use the
locale module to obtain appropriate formatting.</p>
<p>The proposal works well with floats, ints, and decimals.
It also allows easy substitution for other separators.
For example:</p>
<pre class="literal-block">
format(n, &quot;6,d&quot;).replace(&quot;,&quot;, &quot;_&quot;)
</pre>
<p>This technique is completely general but it is awkward in the
one case where the commas and periods need to be swapped:</p>
<pre class="literal-block">
format(n, &quot;6,f&quot;).replace(&quot;,&quot;, &quot;X&quot;).replace(&quot;.&quot;, &quot;,&quot;).replace(&quot;X&quot;, &quot;.&quot;)
</pre>
<p>The <em>width</em> argument means the total length including the commas
and decimal point:</p>
<pre class="literal-block">
format(1234, &quot;08,d&quot;)     --&gt;    '0001,234'
format(1234.5, &quot;08,.1f&quot;) --&gt;    '01,234.5'
</pre>
<p>The ',' option is defined as shown above for types 'd', 'e',
'f', 'g', 'E', 'G', '%', 'F' and ''. To allow future extensions, it is
undefined for other types: binary, octal, hex, character,
etc.</p>
<p>This proposal has the virtue of being simpler than the alternative
proposal but is much less flexible and meets the needs of fewer
users right out of the box.  It is expected that some other
solution will arise for specifying alternative separators.</p>
</div>
<div class="section" id="current-version-of-the-mini-language">
<h1><a class="toc-backref" href="#id22">Current Version of the Mini-Language</a></h1>
<ul class="simple">
<li><a class="reference external" href="https://docs.python.org/2.6/library/string.html#formatstrings">Python 2.6 docs</a> <a class="footnote-reference" href="#id6" id="id7">[3]</a></li>
<li><a class="reference external" href="/dev/peps/pep-3101">PEP 3101</a> Advanced String Formatting</li>
</ul>
</div>
<div class="section" id="research-into-what-other-languages-do">
<h1><a class="toc-backref" href="#id23">Research into what Other Languages Do</a></h1>
<p>Scanning the web, I've found that thousands separators are
usually one of COMMA, DOT, SPACE, APOSTROPHE or UNDERSCORE.</p>
<p><a class="reference external" href="http://blog.stevex.net/index.php/string-formatting-in-csharp/">C-Sharp</a> <a class="footnote-reference" href="#id8" id="id9">[4]</a> provides both styles (picture formatting and type specifiers).
The type specifier approach is locale aware.  The picture formatting only
offers a COMMA as a thousands separator:</p>
<pre class="literal-block">
String.Format(&quot;{0:n}&quot;, 12400)     ==&gt;    &quot;12,400&quot;
String.Format(&quot;{0:0,0}&quot;, 12400)   ==&gt;    &quot;12,400&quot;
</pre>
<p><a class="reference external" href="http://www.cs.cmu.edu/Groups/AI/html/cltl/clm/node200.html">Common Lisp</a> <a class="footnote-reference" href="#id10" id="id11">[5]</a> uses a COLON before the <tt class="docutils literal">~D</tt> decimal type specifier to
emit a COMMA as a thousands separator.  The  general form of <tt class="docutils literal">~D</tt> is
<tt class="docutils literal">~mincol,padchar,commachar,commaintervalD</tt>.  The <em>padchar</em> defaults
to SPACE.  The <em>commachar</em> defaults to COMMA.  The <em>commainterval</em>
defaults to three.</p>
<pre class="literal-block">
(format nil &quot;~:D&quot; 229345007)   =&gt;   &quot;229,345,007&quot;
</pre>
<ul class="simple">
<li>The <a class="reference external" href="http://archive.adaic.com/standards/83lrm/html/lrm-02-04.html">ADA language</a> <a class="footnote-reference" href="#id12" id="id13">[6]</a> allows UNDERSCORES in its numeric literals.</li>
</ul>
<p>Visual Basic and its brethren (like <a class="reference external" href="http://www.brainbell.com/tutorials/ms-office/excel/Create_Custom_Number_Formats.htm">MS Excel</a> <a class="footnote-reference" href="#id14" id="id15">[7]</a>) use a completely
different style and have ultra-flexible custom format
specifiers like:</p>
<pre class="literal-block">
&quot;_($* #,##0_)&quot;.
</pre>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Cobol#Syntactic_features">COBOL</a> <a class="footnote-reference" href="#id16" id="id17">[8]</a> uses picture clauses like:</p>
<pre class="literal-block">
PICTURE $***,**9.99CR
</pre>
<p>Java offers a <a class="reference external" href="http://java.sun.com/javase/6/docs/api/java/text/DecimalFormat.html">Decimal.Format Class</a> <a class="footnote-reference" href="#id18" id="id19">[9]</a> that uses picture patterns (one
for positive numbers and an optional one for negatives) such as:
<tt class="docutils literal"><span class="pre">&quot;#,##0.00;(#,##0.00)&quot;</span></tt>. It allows arbitrary groupings including
hundreds and ten-thousands and uneven groupings.  The special patten
characters are non-localized (using a DOT for a decimal separator and
a COMMA for a grouping separator).  The user can supply an alternate
set of symbols using the formatter's <em>DecimalFormatSymbols</em> object.</p>
</div>
<div class="section" id="alternative-proposal-from-eric-smith-originally-called-proposal-ii">
<h1><a class="toc-backref" href="#id24">Alternative Proposal (from Eric Smith, originally called Proposal II)</a></h1>
<p>Make both the thousands separator and decimal separator user
specifiable but not locale aware.  For simplicity, limit the
choices to a COMMA, DOT, SPACE, APOSTROPHE or UNDERSCORE.
The SPACE can be either U+0020 or U+00A0.</p>
<p>Whenever a separator is followed by a precision, it is a
decimal separator and an optional separator preceding it is a
thousands separator.  When the precision is absent, a lone
specifier means a thousands separator:</p>
<pre class="literal-block">
[[fill]align][sign][#][0][width][tsep][dsep precision][type]
</pre>
<p>Examples:</p>
<pre class="literal-block">
format(1234, &quot;8.1f&quot;)     --&gt;    '  1234.0'
format(1234, &quot;8,1f&quot;)     --&gt;    '  1234,0'
format(1234, &quot;8.,1f&quot;)    --&gt;    ' 1.234,0'
format(1234, &quot;8 ,f&quot;)     --&gt;    ' 1 234,0'
format(1234, &quot;8d&quot;)       --&gt;    '    1234'
format(1234, &quot;8,d&quot;)      --&gt;    '   1,234'
format(1234, &quot;8_d&quot;)      --&gt;    '   1_234'
</pre>
<p>This proposal meets mosts needs, but it comes at the expense
of taking a bit more effort to parse.  Not every possible
convention is covered, but at least one of the options (spaces
or underscores) should be readable, understandable, and useful
to folks from many diverse backgrounds.</p>
<p>As shown in the examples, the <em>width</em> argument means the total
length including the thousands separators and decimal separators.</p>
<p>No change is proposed for the locale module.</p>
<p>The thousands separator is defined as shown above for types
'd', 'e', 'f', 'g', '%', 'E', 'G' and 'F'. To allow future
extensions, it is undefined for other types: binary, octal,
hex, character, etc.</p>
<p>The drawback to this alternative proposal is the difficulty
of mentally parsing whether a single separator is a thousands
separator or decimal separator.  Perhaps it is too arcane
to link the decimal separator with the precision specifier.</p>
</div>
<div class="section" id="commentary">
<h1><a class="toc-backref" href="#id25">Commentary</a></h1>
<ul class="simple">
<li>Some commenters do not like the idea of format strings at all
and find them to be unreadable.  Suggested alternatives include
the COBOL style PICTURE approach or a convenience function with
keyword arguments for every possible combination.</li>
<li>Some newsgroup respondants think there is no place for any
scripts that are not internationalized and that it is a step
backwards to provide a simple way to hardwire a particular choice
(thus reducing incentive to use a locale sensitive approach).</li>
<li>Another thought is that embedding some particular convention in
individual format strings makes it hard to change that convention
later.  No workable alternative was suggested but the general idea
is to set the convention once and have it apply everywhere (others
commented that locale already provides a way to do this).</li>
<li>There are some precedents for grouping digits in the fractional
part of a floating point number, but this PEP does not venture into
that territory.  Only digits to the left of the decimal point are
grouped.  This does not preclude future extensions; it just focuses
on a single, generally useful extension to the formatting language.</li>
<li>James Knight observed that Indian/Pakistani numbering systems
group by hundreds.   Ben Finney noted that Chinese group by
ten-thousands.  Eric Smith pointed-out that these are already
handled by the &quot;n&quot; specifier in the locale module (albeit only
for integers).  This PEP does not attempt to support all of those
possibilities.  It focues on a single, relatively common grouping
convention that offers a quick way to improve readability in many
(though not all) contexts.</li>
</ul>
</div>
<div class="section" id="id1">
<h1><a class="toc-backref" href="#id26">References</a></h1>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[1]</a></td><td><a class="reference external" href="https://docs.python.org/2.6/library/locale.html#background-details-hints-tips-and-caveats">https://docs.python.org/2.6/library/locale.html#background-details-hints-tips-and-caveats</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[2]</a></td><td><a class="reference external" href="http://babel.edgewall.org/">http://babel.edgewall.org/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[3]</a></td><td><a class="reference external" href="https://docs.python.org/2.6/library/string.html#formatstrings">https://docs.python.org/2.6/library/string.html#formatstrings</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[4]</a></td><td><a class="reference external" href="http://blog.stevex.net/index.php/string-formatting-in-csharp/">http://blog.stevex.net/index.php/string-formatting-in-csharp/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11">[5]</a></td><td><a class="reference external" href="http://www.cs.cmu.edu/Groups/AI/html/cltl/clm/node200.html">http://www.cs.cmu.edu/Groups/AI/html/cltl/clm/node200.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id13">[6]</a></td><td><a class="reference external" href="http://archive.adaic.com/standards/83lrm/html/lrm-02-04.html">http://archive.adaic.com/standards/83lrm/html/lrm-02-04.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id15">[7]</a></td><td><a class="reference external" href="http://www.brainbell.com/tutorials/ms-office/excel/Create_Custom_Number_Formats.htm">http://www.brainbell.com/tutorials/ms-office/excel/Create_Custom_Number_Formats.htm</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id16" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id17">[8]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Cobol#Syntactic_features">http://en.wikipedia.org/wiki/Cobol#Syntactic_features</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id18" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id19">[9]</a></td><td><a class="reference external" href="http://java.sun.com/javase/6/docs/api/java/text/DecimalFormat.html">http://java.sun.com/javase/6/docs/api/java/text/DecimalFormat.html</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id27">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
coding: utf-8
End: -->
</div>


<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">324</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">subprocess - New process module</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="https://hg.python.org/peps/file/tip/pep-0324.txt">$Date$</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Peter Astrand &lt;astrand&#32;&#97;t&#32;lysator.liu.se&gt;</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Final</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">19-Nov-2003</td>
</tr>
<tr class="field"><th class="field-name">Python-Version:</th><td class="field-body">2.4</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id13">Abstract</a></li>
<li><a class="reference internal" href="#motivation" id="id14">Motivation</a></li>
<li><a class="reference internal" href="#rationale" id="id15">Rationale</a></li>
<li><a class="reference internal" href="#specification" id="id16">Specification</a><ul>
<li><a class="reference internal" href="#exceptions" id="id17">Exceptions</a></li>
<li><a class="reference internal" href="#security" id="id18">Security</a></li>
<li><a class="reference internal" href="#popen-objects" id="id19">Popen objects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#replacing-older-functions-with-the-subprocess-module" id="id20">Replacing older functions with the subprocess module</a><ul>
<li><a class="reference internal" href="#replacing-bin-sh-shell-backquote" id="id21">Replacing /bin/sh shell backquote</a></li>
<li><a class="reference internal" href="#replacing-shell-pipe-line" id="id22">Replacing shell pipe line</a></li>
<li><a class="reference internal" href="#replacing-os-system" id="id23">Replacing <tt class="docutils literal">os.system()</tt></a></li>
<li><a class="reference internal" href="#replacing-os-spawn" id="id24">Replacing <tt class="docutils literal">os.spawn*</tt></a></li>
<li><a class="reference internal" href="#replacing-os-popen" id="id25">Replacing <tt class="docutils literal">os.popen*</tt></a></li>
<li><a class="reference internal" href="#replacing-popen2" id="id26">Replacing <tt class="docutils literal">popen2.*</tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open-issues" id="id27">Open Issues</a></li>
<li><a class="reference internal" href="#backwards-compatibility" id="id28">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#reference-implementation" id="id29">Reference Implementation</a></li>
<li><a class="reference internal" href="#references" id="id30">References</a></li>
<li><a class="reference internal" href="#copyright" id="id31">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id13">Abstract</a></h1>
<p>This PEP describes a new module for starting and communicating
with processes.</p>
</div>
<div class="section" id="motivation">
<h1><a class="toc-backref" href="#id14">Motivation</a></h1>
<p>Starting new processes is a common task in any programming
language, and very common in a high-level language like Python.
Good support for this task is needed, because:</p>
<ul class="simple">
<li>Inappropriate functions for starting processes could mean a
security risk: If the program is started through the shell, and
the arguments contain shell meta characters, the result can be
disastrous. <a class="footnote-reference" href="#id7" id="id1">[1]</a></li>
<li>It makes Python an even better replacement language for
over-complicated shell scripts.</li>
</ul>
<p>Currently, Python has a large number of different functions for
process creation.  This makes it hard for developers to choose.</p>
<p>The subprocess module provides the following enhancements over
previous functions:</p>
<ul class="simple">
<li>One &quot;unified&quot; module provides all functionality from previous
functions.</li>
<li>Cross-process exceptions: Exceptions happening in the child
before the new process has started to execute are re-raised in
the parent.  This means that it's easy to handle <tt class="docutils literal">exec()</tt>
failures, for example.  With popen2, for example, it's
impossible to detect if the execution failed.</li>
<li>A hook for executing custom code between fork and exec.  This
can be used for, for example, changing uid.</li>
<li>No implicit call of /bin/sh.  This means that there is no need
for escaping dangerous shell meta characters.</li>
<li>All combinations of file descriptor redirection is possible.
For example, the &quot;python-dialog&quot; <a class="footnote-reference" href="#id8" id="id2">[2]</a> needs to spawn a process
and redirect stderr, but not stdout.  This is not possible with
current functions, without using temporary files.</li>
<li>With the subprocess module, it's possible to control if all open
file descriptors should be closed before the new program is
executed.</li>
<li>Support for connecting several subprocesses (shell &quot;pipe&quot;).</li>
<li>Universal newline support.</li>
<li>A <tt class="docutils literal">communicate()</tt> method, which makes it easy to send stdin data
and read stdout and stderr data, without risking deadlocks.
Most people are aware of the flow control issues involved with
child process communication, but not all have the patience or
skills to write a fully correct and deadlock-free select loop.
This means that many Python applications contain race
conditions.  A <tt class="docutils literal">communicate()</tt> method in the standard library
solves this problem.</li>
</ul>
</div>
<div class="section" id="rationale">
<h1><a class="toc-backref" href="#id15">Rationale</a></h1>
<p>The following points summarizes the design:</p>
<ul>
<li><p class="first">subprocess was based on popen2, which is tried-and-tested.</p>
</li>
<li><p class="first">The factory functions in popen2 have been removed, because I
consider the class constructor equally easy to work with.</p>
</li>
<li><p class="first">popen2 contains several factory functions and classes for
different combinations of redirection.  subprocess, however,
contains one single class.  Since the subprocess module supports
12 different combinations of redirection, providing a class or
function for each of them would be cumbersome and not very
intuitive.  Even with popen2, this is a readability problem.
For example, many people cannot tell the difference between
popen2.popen2 and popen2.popen4 without using the documentation.</p>
</li>
<li><p class="first">One small utility function is provided: <tt class="docutils literal">subprocess.call()</tt>. It
aims to be an enhancement over <tt class="docutils literal">os.system()</tt>, while still very
easy to use:</p>
<ul class="simple">
<li>It does not use the Standard C function system(), which has
limitations.</li>
<li>It does not call the shell implicitly.</li>
<li>No need for quoting; using an argument list.</li>
<li>The return value is easier to work with.</li>
</ul>
<p>The <tt class="docutils literal">call()</tt> utility function accepts an 'args' argument, just
like the <tt class="docutils literal">Popen</tt> class constructor.  It waits for the command to
complete, then returns the <tt class="docutils literal">returncode</tt> attribute.  The
implementation is very simple:</p>
<pre class="literal-block">
def call(*args, **kwargs):
    return Popen(*args, **kwargs).wait()
</pre>
<p>The motivation behind the <tt class="docutils literal">call()</tt> function is simple: Starting a
process and wait for it to finish is a common task.</p>
<p>While <tt class="docutils literal">Popen</tt> supports a wide range of options, many users have
simple needs.  Many people are using <tt class="docutils literal">os.system()</tt> today, mainly
because it provides a simple interface.  Consider this example:</p>
<pre class="literal-block">
os.system(&quot;stty sane -F &quot; + device)
</pre>
<p>With <tt class="docutils literal">subprocess.call()</tt>, this would look like:</p>
<pre class="literal-block">
subprocess.call([&quot;stty&quot;, &quot;sane&quot;, &quot;-F&quot;, device])
</pre>
<p>or, if executing through the shell:</p>
<pre class="literal-block">
subprocess.call(&quot;stty sane -F &quot; + device, shell=True)
</pre>
</li>
<li><p class="first">The &quot;preexec&quot; functionality makes it possible to run arbitrary
code between fork and exec.  One might ask why there are special
arguments for setting the environment and current directory, but
not for, for example, setting the uid.  The answer is:</p>
<ul class="simple">
<li>Changing environment and working directory is considered
fairly common.</li>
<li>Old functions like <tt class="docutils literal">spawn()</tt> has support for an
&quot;env&quot;-argument.</li>
<li>env and cwd are considered quite cross-platform: They make
sense even on Windows.</li>
</ul>
</li>
<li><p class="first">On POSIX platforms, no extension module is required: the module
uses <tt class="docutils literal">os.fork()</tt>, <tt class="docutils literal">os.execvp()</tt> etc.</p>
</li>
<li><p class="first">On Windows platforms, the module requires either Mark Hammond's
Windows extensions <a class="footnote-reference" href="#id11" id="id3">[5]</a>, or a small extension module called
_subprocess.</p>
</li>
</ul>
</div>
<div class="section" id="specification">
<h1><a class="toc-backref" href="#id16">Specification</a></h1>
<p>This module defines one class called Popen:</p>
<pre class="literal-block">
class Popen(args, bufsize=0, executable=None,
            stdin=None, stdout=None, stderr=None,
            preexec_fn=None, close_fds=False, shell=False,
            cwd=None, env=None, universal_newlines=False,
            startupinfo=None, creationflags=0):
</pre>
<p>Arguments are:</p>
<ul>
<li><p class="first"><tt class="docutils literal">args</tt> should be a string, or a sequence of program arguments.
The program to execute is normally the first item in the args
sequence or string, but can be explicitly set by using the
executable argument.</p>
<p>On UNIX, with <tt class="docutils literal">shell=False</tt> (default): In this case, the <tt class="docutils literal">Popen</tt>
class uses <tt class="docutils literal">os.execvp()</tt> to execute the child program.  <tt class="docutils literal">args</tt>
should normally be a sequence.  A string will be treated as a
sequence with the string as the only item (the program to
execute).</p>
<p>On UNIX, with <tt class="docutils literal">shell=True</tt>: If <tt class="docutils literal">args</tt> is a string, it specifies the
command string to execute through the shell.  If <tt class="docutils literal">args</tt> is a
sequence, the first item specifies the command string, and any
additional items will be treated as additional shell arguments.</p>
<p>On Windows: the <tt class="docutils literal">Popen</tt> class uses <tt class="docutils literal">CreateProcess()</tt> to execute the
child program, which operates on strings.  If <tt class="docutils literal">args</tt> is a
sequence, it will be converted to a string using the
<tt class="docutils literal">list2cmdline</tt> method.  Please note that not all MS Windows
applications interpret the command line the same way: The
<tt class="docutils literal">list2cmdline</tt> is designed for applications using the same rules
as the MS C runtime.</p>
</li>
<li><p class="first"><tt class="docutils literal">bufsize</tt>, if given, has the same meaning as the corresponding
argument to the built-in <tt class="docutils literal">open()</tt> function: 0 means unbuffered, 1
means line buffered, any other positive value means use a buffer
of (approximately) that size.  A negative <tt class="docutils literal">bufsize</tt> means to use
the system default, which usually means fully buffered.  The
default value for <tt class="docutils literal">bufsize</tt> is 0 (unbuffered).</p>
</li>
<li><p class="first"><tt class="docutils literal">stdin</tt>, <tt class="docutils literal">stdout</tt> and <tt class="docutils literal">stderr</tt> specify the executed programs' standard
input, standard output and standard error file handles,
respectively.  Valid values are <tt class="docutils literal">PIPE</tt>, an existing file
descriptor (a positive integer), an existing file object, and
<tt class="docutils literal">None</tt>.  <tt class="docutils literal">PIPE</tt> indicates that a new pipe to the child should be
created.  With <tt class="docutils literal">None</tt>, no redirection will occur; the child's file
handles will be inherited from the parent.  Additionally, <tt class="docutils literal">stderr</tt>
can be STDOUT, which indicates that the stderr data from the
applications should be captured into the same file handle as for
stdout.</p>
</li>
<li><p class="first">If <tt class="docutils literal">preexec_fn</tt> is set to a callable object, this object will be
called in the child process just before the child is executed.</p>
</li>
<li><p class="first">If <tt class="docutils literal">close_fds</tt> is true, all file descriptors except 0, 1 and 2
will be closed before the child process is executed.</p>
</li>
<li><p class="first">If <tt class="docutils literal">shell</tt> is true, the specified command will be executed through
the shell.</p>
</li>
<li><p class="first">If <tt class="docutils literal">cwd</tt> is not <tt class="docutils literal">None</tt>, the current directory will be changed to cwd
before the child is executed.</p>
</li>
<li><p class="first">If <tt class="docutils literal">env</tt> is not <tt class="docutils literal">None</tt>, it defines the environment variables for the
new process.</p>
</li>
<li><p class="first">If <tt class="docutils literal">universal_newlines</tt> is true, the file objects stdout and
stderr are opened as a text file, but lines may be terminated
by any of <tt class="docutils literal">\n</tt>, the Unix end-of-line convention, <tt class="docutils literal">\r</tt>, the
Macintosh convention or <tt class="docutils literal">\r\n</tt>, the Windows convention.  All of
these external representations are seen as <tt class="docutils literal">\n</tt> by the Python
program.  Note: This feature is only available if Python is
built with universal newline support (the default).  Also, the
newlines attribute of the file objects stdout, stdin and stderr
are not updated by the <tt class="docutils literal">communicate()</tt> method.</p>
</li>
<li><p class="first">The <tt class="docutils literal">startupinfo</tt> and <tt class="docutils literal">creationflags</tt>, if given, will be passed to
the underlying <tt class="docutils literal">CreateProcess()</tt> function.  They can specify
things such as appearance of the main window and priority for
the new process.  (Windows only)</p>
</li>
</ul>
<p>This module also defines two shortcut functions:</p>
<ul>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">call(*args,</span> **kwargs)</tt>:</dt>
<dd><p class="first">Run command with arguments.  Wait for command to complete,
then return the <tt class="docutils literal">returncode</tt> attribute.</p>
<p>The arguments are the same as for the Popen constructor.
Example:</p>
<pre class="last literal-block">
retcode = call([&quot;ls&quot;, &quot;-l&quot;])
</pre>
</dd>
</dl>
</li>
</ul>
<div class="section" id="exceptions">
<h2><a class="toc-backref" href="#id17">Exceptions</a></h2>
<p>Exceptions raised in the child process, before the new program has
started to execute, will be re-raised in the parent.
Additionally, the exception object will have one extra attribute
called 'child_traceback', which is a string containing traceback
information from the child's point of view.</p>
<p>The most common exception raised is <tt class="docutils literal">OSError</tt>.  This occurs, for
example, when trying to execute a non-existent file.  Applications
should prepare for <tt class="docutils literal">OSErrors</tt>.</p>
<p>A <tt class="docutils literal">ValueError</tt> will be raised if Popen is called with invalid
arguments.</p>
</div>
<div class="section" id="security">
<h2><a class="toc-backref" href="#id18">Security</a></h2>
<p>Unlike some other popen functions, this implementation will never
call /bin/sh implicitly.  This means that all characters,
including shell meta-characters, can safely be passed to child
processes.</p>
</div>
<div class="section" id="popen-objects">
<h2><a class="toc-backref" href="#id19">Popen objects</a></h2>
<p>Instances of the Popen class have the following methods:</p>
<dl class="docutils">
<dt><tt class="docutils literal">poll()</tt></dt>
<dd>Check if child process has terminated.  Returns <tt class="docutils literal">returncode</tt>
attribute.</dd>
<dt><tt class="docutils literal">wait()</tt></dt>
<dd>Wait for child process to terminate.  Returns <tt class="docutils literal">returncode</tt>
attribute.</dd>
<dt><tt class="docutils literal">communicate(input=None)</tt></dt>
<dd><p class="first">Interact with process: Send data to stdin.  Read data from
stdout and stderr, until end-of-file is reached.  Wait for
process to terminate.  The optional stdin argument should be a
string to be sent to the child process, or <tt class="docutils literal">None</tt>, if no data
should be sent to the child.</p>
<p><tt class="docutils literal">communicate()</tt> returns a tuple <tt class="docutils literal">(stdout, stderr)</tt>.</p>
<p class="last">Note: The data read is buffered in memory, so do not use this
method if the data size is large or unlimited.</p>
</dd>
</dl>
<p>The following attributes are also available:</p>
<dl class="docutils">
<dt><tt class="docutils literal">stdin</tt></dt>
<dd>If the <tt class="docutils literal">stdin</tt> argument is <tt class="docutils literal">PIPE</tt>, this attribute is a file object
that provides input to the child process.  Otherwise, it is
<tt class="docutils literal">None</tt>.</dd>
<dt><tt class="docutils literal">stdout</tt></dt>
<dd>If the <tt class="docutils literal">stdout</tt> argument is <tt class="docutils literal">PIPE</tt>, this attribute is a file
object that provides output from the child process.
Otherwise, it is <tt class="docutils literal">None</tt>.</dd>
<dt><tt class="docutils literal">stderr</tt></dt>
<dd>If the <tt class="docutils literal">stderr</tt> argument is <tt class="docutils literal">PIPE</tt>, this attribute is file object
that provides error output from the child process.  Otherwise,
it is <tt class="docutils literal">None</tt>.</dd>
<dt><tt class="docutils literal">pid</tt></dt>
<dd>The process ID of the child process.</dd>
<dt><tt class="docutils literal">returncode</tt></dt>
<dd>The child return code.  A <tt class="docutils literal">None</tt> value indicates that the
process hasn't terminated yet.  A negative value -N indicates
that the child was terminated by signal N (UNIX only).</dd>
</dl>
</div>
</div>
<div class="section" id="replacing-older-functions-with-the-subprocess-module">
<h1><a class="toc-backref" href="#id20">Replacing older functions with the subprocess module</a></h1>
<p>In this section, &quot;a ==&gt; b&quot; means that b can be used as a
replacement for a.</p>
<p>Note: All functions in this section fail (more or less) silently
if the executed program cannot be found; this module raises an
OSError exception.</p>
<p>In the following examples, we assume that the subprocess module is
imported with <tt class="docutils literal">from subprocess import *</tt>.</p>
<div class="section" id="replacing-bin-sh-shell-backquote">
<h2><a class="toc-backref" href="#id21">Replacing /bin/sh shell backquote</a></h2>
<pre class="literal-block">
output=`mycmd myarg`
==&gt;
output = Popen([&quot;mycmd&quot;, &quot;myarg&quot;], stdout=PIPE).communicate()[0]
</pre>
</div>
<div class="section" id="replacing-shell-pipe-line">
<h2><a class="toc-backref" href="#id22">Replacing shell pipe line</a></h2>
<pre class="literal-block">
output=`dmesg | grep hda`
==&gt;
p1 = Popen([&quot;dmesg&quot;], stdout=PIPE)
p2 = Popen([&quot;grep&quot;, &quot;hda&quot;], stdin=p1.stdout, stdout=PIPE)
output = p2.communicate()[0]
</pre>
</div>
<div class="section" id="replacing-os-system">
<h2><a class="toc-backref" href="#id23">Replacing <tt class="docutils literal">os.system()</tt></a></h2>
<pre class="literal-block">
sts = os.system(&quot;mycmd&quot; + &quot; myarg&quot;)
==&gt;
p = Popen(&quot;mycmd&quot; + &quot; myarg&quot;, shell=True)
sts = os.waitpid(p.pid, 0)
</pre>
<p>Note:</p>
<ul class="simple">
<li>Calling the program through the shell is usually not required.</li>
<li>It's easier to look at the returncode attribute than the
exit status.</li>
</ul>
<p>A more real-world example would look like this:</p>
<pre class="literal-block">
try:
    retcode = call(&quot;mycmd&quot; + &quot; myarg&quot;, shell=True)
    if retcode &lt; 0:
        print &gt;&gt;sys.stderr, &quot;Child was terminated by signal&quot;, -retcode
    else:
        print &gt;&gt;sys.stderr, &quot;Child returned&quot;, retcode
except OSError, e:
    print &gt;&gt;sys.stderr, &quot;Execution failed:&quot;, e
</pre>
</div>
<div class="section" id="replacing-os-spawn">
<h2><a class="toc-backref" href="#id24">Replacing <tt class="docutils literal">os.spawn*</tt></a></h2>
<p>P_NOWAIT example:</p>
<pre class="literal-block">
pid = os.spawnlp(os.P_NOWAIT, &quot;/bin/mycmd&quot;, &quot;mycmd&quot;, &quot;myarg&quot;)
==&gt;
pid = Popen([&quot;/bin/mycmd&quot;, &quot;myarg&quot;]).pid
</pre>
<p>P_WAIT example:</p>
<pre class="literal-block">
retcode = os.spawnlp(os.P_WAIT, &quot;/bin/mycmd&quot;, &quot;mycmd&quot;, &quot;myarg&quot;)
==&gt;
retcode = call([&quot;/bin/mycmd&quot;, &quot;myarg&quot;])
</pre>
<p>Vector example:</p>
<pre class="literal-block">
os.spawnvp(os.P_NOWAIT, path, args)
==&gt;
Popen([path] + args[1:])
</pre>
<p>Environment example:</p>
<pre class="literal-block">
os.spawnlpe(os.P_NOWAIT, &quot;/bin/mycmd&quot;, &quot;mycmd&quot;, &quot;myarg&quot;, env)
==&gt;
Popen([&quot;/bin/mycmd&quot;, &quot;myarg&quot;], env={&quot;PATH&quot;: &quot;/usr/bin&quot;})
</pre>
</div>
<div class="section" id="replacing-os-popen">
<h2><a class="toc-backref" href="#id25">Replacing <tt class="docutils literal">os.popen*</tt></a></h2>
<pre class="literal-block">
pipe = os.popen(cmd, mode='r', bufsize)
==&gt;
pipe = Popen(cmd, shell=True, bufsize=bufsize, stdout=PIPE).stdout

pipe = os.popen(cmd, mode='w', bufsize)
==&gt;
pipe = Popen(cmd, shell=True, bufsize=bufsize, stdin=PIPE).stdin


(child_stdin, child_stdout) = os.popen2(cmd, mode, bufsize)
==&gt;
p = Popen(cmd, shell=True, bufsize=bufsize,
          stdin=PIPE, stdout=PIPE, close_fds=True)
(child_stdin, child_stdout) = (p.stdin, p.stdout)


(child_stdin,
 child_stdout,
 child_stderr) = os.popen3(cmd, mode, bufsize)
==&gt;
p = Popen(cmd, shell=True, bufsize=bufsize,
          stdin=PIPE, stdout=PIPE, stderr=PIPE, close_fds=True)
(child_stdin,
 child_stdout,
 child_stderr) = (p.stdin, p.stdout, p.stderr)


(child_stdin, child_stdout_and_stderr) = os.popen4(cmd, mode, bufsize)
==&gt;
p = Popen(cmd, shell=True, bufsize=bufsize,
          stdin=PIPE, stdout=PIPE, stderr=STDOUT, close_fds=True)
(child_stdin, child_stdout_and_stderr) = (p.stdin, p.stdout)
</pre>
</div>
<div class="section" id="replacing-popen2">
<h2><a class="toc-backref" href="#id26">Replacing <tt class="docutils literal">popen2.*</tt></a></h2>
<p>Note: If the cmd argument to <tt class="docutils literal">popen2</tt> functions is a string, the
command is executed through /bin/sh.  If it is a list, the command
is directly executed.</p>
<pre class="literal-block">
(child_stdout, child_stdin) = popen2.popen2(&quot;somestring&quot;, bufsize, mode)
==&gt;
p = Popen([&quot;somestring&quot;], shell=True, bufsize=bufsize
          stdin=PIPE, stdout=PIPE, close_fds=True)
(child_stdout, child_stdin) = (p.stdout, p.stdin)


(child_stdout, child_stdin) = popen2.popen2([&quot;mycmd&quot;, &quot;myarg&quot;], bufsize, mode)
==&gt;
p = Popen([&quot;mycmd&quot;, &quot;myarg&quot;], bufsize=bufsize,
          stdin=PIPE, stdout=PIPE, close_fds=True)
(child_stdout, child_stdin) = (p.stdout, p.stdin)
</pre>
<p>The <tt class="docutils literal">popen2.Popen3</tt> and <tt class="docutils literal">popen3.Popen4</tt> basically works as
<tt class="docutils literal">subprocess.Popen</tt>, except that:</p>
<ul class="simple">
<li><tt class="docutils literal">subprocess.Popen</tt> raises an exception if the execution fails</li>
<li>the <tt class="docutils literal">capturestderr</tt> argument is replaced with the stderr argument.</li>
<li><tt class="docutils literal">stdin=PIPE</tt> and <tt class="docutils literal">stdout=PIPE</tt> must be specified.</li>
<li><tt class="docutils literal">popen2</tt> closes all file descriptors by default, but you have to
specify <tt class="docutils literal">close_fds=True</tt> with <tt class="docutils literal">subprocess.Popen</tt>.</li>
</ul>
</div>
</div>
<div class="section" id="open-issues">
<h1><a class="toc-backref" href="#id27">Open Issues</a></h1>
<p>Some features have been requested but is not yet implemented.
This includes:</p>
<ul class="simple">
<li>Support for managing a whole flock of subprocesses</li>
<li>Support for managing &quot;daemon&quot; processes</li>
<li>Built-in method for killing subprocesses</li>
</ul>
<p>While these are useful features, it's expected that these can be
added later without problems.</p>
<ul class="simple">
<li>expect-like functionality, including pty support.</li>
</ul>
<p>pty support is highly platform-dependent, which is a
problem.  Also, there are already other modules that provide this
kind of functionality <a class="footnote-reference" href="#id12" id="id4">[6]</a>.</p>
</div>
<div class="section" id="backwards-compatibility">
<h1><a class="toc-backref" href="#id28">Backwards Compatibility</a></h1>
<p>Since this is a new module, no major backward compatible issues
are expected.  The module name &quot;subprocess&quot; might collide with
other, previous modules <a class="footnote-reference" href="#id9" id="id5">[3]</a> with the same name, but the name
&quot;subprocess&quot; seems to be the best suggested name so far.  The
first name of this module was &quot;popen5&quot;, but this name was
considered too unintuitive.  For a while, the module was called
&quot;process&quot;, but this name is already used by Trent Mick's
module <a class="footnote-reference" href="#id10" id="id6">[4]</a>.</p>
<p>The functions and modules that this new module is trying to
replace (<tt class="docutils literal">os.system</tt>, <tt class="docutils literal">os.spawn*</tt>, <tt class="docutils literal">os.popen*</tt>, <tt class="docutils literal">popen2.*</tt>,
<tt class="docutils literal">commands.*</tt>) are expected to be available in future Python versions
for a long time, to preserve backwards compatibility.</p>
</div>
<div class="section" id="reference-implementation">
<h1><a class="toc-backref" href="#id29">Reference Implementation</a></h1>
<p>A reference implementation is available from
<a class="reference external" href="http://www.lysator.liu.se/~astrand/popen5/">http://www.lysator.liu.se/~astrand/popen5/</a>.</p>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id30">References</a></h1>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Secure Programming for Linux and Unix HOWTO, section 8.3.
<a class="reference external" href="http://www.dwheeler.com/secure-programs/">http://www.dwheeler.com/secure-programs/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Python Dialog
<a class="reference external" href="http://pythondialog.sourceforge.net/">http://pythondialog.sourceforge.net/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[3]</a></td><td><a class="reference external" href="http://www.iol.ie/~padraiga/libs/subProcess.py">http://www.iol.ie/~padraiga/libs/subProcess.py</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[4]</a></td><td><a class="reference external" href="http://starship.python.net/crew/tmick/">http://starship.python.net/crew/tmick/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[5]</a></td><td><a class="reference external" href="http://starship.python.net/crew/mhammond/win32/">http://starship.python.net/crew/mhammond/win32/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[6]</a></td><td><a class="reference external" href="http://www.lysator.liu.se/~ceder/pcl-expect/">http://www.lysator.liu.se/~ceder/pcl-expect/</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id31">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
End: -->
</div>

